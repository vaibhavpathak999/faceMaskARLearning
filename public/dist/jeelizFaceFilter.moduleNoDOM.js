 /**
 * Jeeliz Face Filter - https://github.com/jeeliz/jeelizFaceFilter
 *
 * Copyright 2018 Jeeliz ( https://jeeliz.com )
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

// BEGIN EMULATE DOM

// import some usefull stuffs
try {
  var Buffer = require('buffer').Buffer;
} catch(err) {
  console.log('Cannot import Buffer package');
}

// emulate global variables:
const navigator = {  
  platform: "Linux x86_64",
  userAgent: "forceWebGL1_noAntialiasing_noDOM"
};

const window = {
  canvas: null,
  innnerWidth: -1,
  innerHeight: -1,
  URL: {
    createObjectURL: function() {
      return null
    }
  },
  addEventListener: function() {},
  removeEventListener: function() {},
  requestAnimationFrame: function(step) {
    if (window.canvas === null){
      setTimeout(step, 1);
      return;
    }
    window.canvas.requestAnimationFrame(step)
  },
  cancelAnimationFrame: function(step) {
    if (window.canvas === null){
      return;
    }
    window.canvas.cancelAnimationFrame(step)
  },
  setCanvas: function(c) {
    window.canvas = c;
  }
};

const document = {
  createElement: function(elementType){
    switch(elementType){
      case 'canvas':
        return null; // return a real canvas
    }
  },
  getElementById: function(elementId){
    return null;
  },
  body: { appendChild: function(element){ return null; }}
};

if(typeof(wx) !== 'undefined'){ //WECHAT
  const systemInfo = wx.getSystemInfoSync()
  window.innnerWidth = systemInfo.windowWidth;
  window.innnerHeight = systemInfo.windowHeight;
}

const FAKEDOM = {
  window: window,
  document: document,
  navigator: navigator
};
// END EMULATE DOM


/*
 SharedContext.is_webgl2() &&*/
window.JEEFACEFILTERAPIGEN=function(){function Fb(a){var c=null,e=null,f=null,k=0;this.B=function(g){this.Ge(g.Va);f.Kd({Lb:g.Lb,Ib:g.Ib})};this.fe=function(g){return c[g]};this.Ge=function(g){var r=null;k=g.length;c=g.map(function(l,h){l=Object.assign({},l,{index:h,parent:this,bb:r,qe:h===k-1});return r=h=0===h?Gb.instance(l):Hb.instance(l)});e=c[0];f=c[k-1];c.forEach(function(l,h){0!==h&&l.Ce()})};this.U=function(g){var r=g;c.forEach(function(l){r=l.U(r,!1)});return r};this.ee=function(){return e.C()};
this.Cc=function(){return f.ge()};this.zc=function(){return f.zc()};this.m=function(){c&&(c.forEach(function(g){g.m()}),f=e=c=null,k=0)};"undefined"!==typeof a&&this.B(a)}function bb(a,c){var e=c%8;return a[(c-e)/8]>>7-e&1}function Ib(a){var c=JSON.parse(a);a=c.ne;var e=c.nf,f=c.n;var k="undefined"===typeof btoa?Buffer.from(c.data,"base64").toString("latin1"):atob(c.data);var g=k.length;c=new Uint8Array(g);for(var r=0;r<g;++r)c[r]=k.charCodeAt(r);k=new Float32Array(f);g=new Float32Array(e);r=a+e+
1;for(var l=0;l<f;++l){for(var h=r*l,w=0===bb(c,h)?1:-1,y=h+1,v=1,d=0,u=y+a-1;u>=y;--u)d+=v*bb(c,u),v*=2;y=d;h=h+1+a;v=g.length;d=0;for(u=h;u<h+v;++u)g[d]=bb(c,u,!0),++d;for(v=h=0;v<e;++v)h+=g[v]*Math.pow(2,-v-1);k[l]=0===h&&0===y?0:w*(1+h)*Math.pow(2,1+y-Math.pow(2,a-1))}return k}function Va(){return-1!==[da.ready,da.play,da.pause].indexOf(ia)}function Jb(a){if(ia!==da.pause){var c=ia===da.play?L.Fa:Y.wd;Wa=setTimeout(ob.bind(null,a),c)}}function cb(){if(ia===da.play)return!1;ia=da.play;Na&&window.cancelAnimationFrame(Na);
ob(0)}function pb(){if(ia!==da.play)return!1;Wa&&(clearTimeout(Wa),Wa=null);Na&&(window.cancelAnimationFrame(Na),Na=null);ia=da.pause;return!0}function Ea(a,c,e,f,k){a=4*(3*c+a)+e;return f+(V.buffer[a]/255+V.buffer[a+12]/65025)*(k-f)}function db(){b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);sa.aa();W.reset();X.reset();z.O();z.nc();b.disable(b.DEPTH_TEST);b.disable(b.BLEND);W.wa();z.pa()}function qb(){sa.N();b.viewport(0,0,3,2*J.o);z.set("s49");V.ra.h(0);W.l(!1,!1);return Fa.cd(0,0,3,2*J.o,V.buffer)}function ob(){ia!==
da.pause&&(z.nc(),W.reset(),W.wa(),b.disable(b.DEPTH_TEST),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),z.pa(),Y.Md?qb().then(function(){rb();sb()}):(rb(),qb().then(sb)))}function rb(){sa.aa();if(!x.Sa)if(x.Ra)x.element.needsUpdate&&(x.L.We(x.element.arrayBuffer),x.element.needsUpdate=!1);else{var a=x.element.currentTime,c=a-x.cb;0>c&&(x.cb=a);1E3*c<Y.Ye||(x.cb+=c,x.L.refresh())}a=Aa.Ac();if(J.V.length>a)J.V.splice(0,J.V.length-a);else for(;J.V.length<a;)J.V.push(0);if(1!==J.o)if(oa.every(eb)){for(var e=
0,f=c=0;f<oa.length;++f)oa[f].detected>e&&(e=oa[f].detected,c=0);for(e=0;e<a;++e)J.V[e]=c}else{c=J.Qc;e=0;for(f=!1;e<a;++e){if(eb(oa[c]))if(f){do++c===J.o&&(c=0);while(eb(oa[c]))}else f=!0;J.V[e]=c++;c>=J.o&&(c=0)}J.Qc=c}for(a=0;a<Aa.Ac();++a)J.ja=J.V[a],J.Hb=(.5+J.ja)/J.o,J.Lc=J.V.lastIndexOf(J.ja)===a,z.set("s51"),c=oa[J.ja],z.G("u37",1+Oa.Ob*(Math.cos(c.ry)-1)),L.ma&&z.G("u36",c.rz),1!==J.o&&z.G("u35",J.Hb),Z.oa.fa(),x.L.h(0),V.ra.h(1),W.l(!1,!1),Z.oa.h(0),Pa.U(Z.oa);Aa.Re()}function sb(){for(var a=
0;a<J.o;++a)if(-1!==J.V.indexOf(a)){var c=a,e=Sa[c],f=[c],k=oa[c],g=fb[c],r=2*c;e.Ja=Ea(1,r,3,0,1);k.detected=ta.W(k.detected,e.Ja,Y.td);if(e.Ja<Y.Sc)L.ma&&(k.rz=0,k.ry=0);else{var l=V.Ba;e.x=Ea(0,r,1,-1,1);e.y=Ea(0,r,2,-1,1);e.Z=Ea(0,r,3,0,1);e.Mb=Ea(1,r,0,-l[0],l[0]);e.Nb=Ea(1,r,1,-l[1],l[1]);e.Ca=Ea(1,r,2,-l[2],l[2]);for(l=0;l<V.X;++l)e.uc[l]=V.Aa[l](Ea(2,r,l,0,1));f.tb=e.x-k.xRaw;f.ub=e.y-k.yRaw;f.sb=e.Z-k.sRaw;f.pb=e.Mb-k.rx;f.qb=e.Nb-k.ry;f.rb=L.ma?e.Ca:e.Ca-k.rz;r=Aa.$d();f=(1-Xa.Wa(ua.translationFactorRange[0],
ua.translationFactorRange[1],Math.sqrt(f.tb*f.tb+f.ub*f.ub+f.sb*f.sb)/r))*(1-Xa.Wa(ua.rotationFactorRange[0],ua.rotationFactorRange[1],Math.sqrt(f.pb*f.pb+f.qb*f.qb+f.rb*f.rb)/r))*Xa.Wa(ua.qualityFactorRange[0],ua.qualityFactorRange[1],e.Ja);c=g[++gb[c]%g.length]=f;for(r=0;r<g.length;++r)c=Math.min(c,g[r]);c=Math.max(.5,c);f=Math.min(c,f);g=ta.W(ua.alphaRange[1],ua.alphaRange[0],Math.pow(f,Y.vd));k.xRaw=ta.W(k.xRaw,e.x,g);k.yRaw=ta.W(k.yRaw,e.y,g);k.sRaw=ta.W(k.sRaw,e.Z,g);k.rx=ta.W(k.rx,e.Mb,g);
k.ry=ta.W(k.ry,e.Nb,g);k.rz=L.ma?k.rz+g*e.Ca:ta.W(k.rz,e.Ca,g);c=k.sRaw*Oa.ob*Math.sin(k.ry);f=Math.sin(k.rz)*c/Qa;k.x=k.xRaw+Math.cos(k.rz)*c;k.y=k.yRaw+f;k.s=k.sRaw;g=Math.max(g,Y.ud);for(c=0;c<V.X;++c)k.expressions[c]=ta.W(k.expressions[c],e.uc[c],g);++e.Za}}sa.Ue();sa.reset();X.reset();b.enable(b.DEPTH_TEST);L.Ia&&(1===J.o?L.Ia(oa[0]):L.Ia(oa));b.disable(b.BLEND);ia===da.play&&(Na=window.requestAnimationFrame(Jb))}function tb(){Z.oa=X.instance({isPot:!0,isFloat:!1,width:Pa.ee()});for(var a=Y.ld,
c=J.o,e=new Float32Array([0,.5,.5,0,0,0,0,0,0,0,0,0]),f=new Float32Array(e.length*J.o),k=0,g;k<J.o;++k)for(g=0;g<e.length;++g)f[k*e.length+g]=e[g];V.ra=Kb.instance({width:a,height:c,isFloat:!0,isPot:!1,array:f})}function Lb(){function a(c){for(var e=[],f=0;f<J.o;++f)e.push(JSON.parse(JSON.stringify(c)));return e}V.buffer=new Uint8Array(8*Y.ld*J.o);Sa=a({Ja:0,x:0,y:0,Z:1,Mb:0,Nb:0,Ca:0,uc:new Float32Array(V.X),Za:0});oa=a({detected:0,x:0,y:0,s:1,xRaw:0,yRaw:0,sRaw:1,rx:0,ry:0,rz:0,expressions:new Float32Array(V.X)});
a({tb:0,ub:0,sb:0,pb:0,qb:0,rb:0})}function hb(){z.S("s51",[{type:"1i",name:"u1",value:0},{type:"1i",name:"u33",value:1},{type:"2f",name:"u34",value:Z.D},{type:"1f",name:"u35",value:.5},{type:"1f",name:"u36",value:0}]);z.S("s52",[{type:"1i",name:"u38",value:0},{type:"1i",name:"u33",value:1},{type:"1f",name:"u41",value:Y.Se},{type:"1f",name:"u42",value:na.threshold},{type:"3f",name:"u40",value:[V.M[0]*Z.D[0],V.M[1]*Z.D[1],V.M[2]]},{type:"1f",name:"u35",value:.5},{type:"1f",name:"u43",value:1},{type:"1f",
name:"u36",value:0}]);var a=[{type:"1i",name:"u38",value:0}];z.S("s53",a);z.S("s54",a);z.S("s49",[{type:"1i",name:"u33",value:0},{type:"1f",name:"u46",value:Z.D[0]},{type:"2f",name:"u45",value:[0,.5/J.o]}])}function ib(){Z.D[0]=1;Z.D[1]=Z.P/Z.K;ub.B({ab:na.overlapFactors,Wc:na.nScaleLevels,P:Z.P,K:Z.K,ed:na.scale0Factor,M:V.M,fd:na.scanCenterFirst})}function Mb(a){if(L.sa)vb("string"===typeof L.sa?JSON.parse(L.sa):L.sa,a);else{var c=L.Zb;"JSON"!==c.toUpperCase().split(".").pop()&&(c+=Y.neuralNetworkPath);
wb.get(c,function(e){e=JSON.parse(e);vb(e,a)})}}function vb(a,c){if(a.exportData){var e=a.exportData;e.rotationEulerAnglesFactors&&(V.Ba=e.rotationEulerAnglesFactors);e.translationScalingFactors&&(V.M=e.translationScalingFactors);"undefined"!==typeof e.nExpressions&&(V.X=e.nExpressions);Oa.Ob=.4;Oa.ob=.7;"undefined"!==typeof e.fgScaleXFactor&&(Oa.Ob=e.fgScaleXFactor);"undefined"!==typeof e.fgDisplaceXFactor&&(Oa.ob=e.fgDisplaceXFactor)}V.X||(V.X=Y.Vc);if(!V.Aa)for(V.Aa=[],e=0;e<V.X;++e)V.Aa.push(Y.Ud);
c(a)}function Nb(){if(Fa.B({lb:L.ba,width:Z.P,height:Z.K,debug:!1,Xc:function(){Ha("GLCONTEXT_LOST")},antialias:L.antialias,premultipliedAlpha:!0}))return!0;Ha("GL_INCOMPATIBLE");return!1}function eb(a){return a.detected<=Y.Sc}function xb(a,c,e,f){return e>a?Math.max(0,a+c/2-(e-f/2)):Math.max(0,e+f/2-(a-c/2))}function Ob(){return Sa.some(function(a,c){if(c===J.ja)return!1;c=Sa[J.ja];if(c.Za>a.Za||3>a.Za||xb(c.x,c.Z,a.x,a.Z)<Y.Tc*c.Z)return!1;var e=Z.P/Z.K;return xb(c.y,c.Z*e,a.y,a.Z*e)>Y.Tc*c.Z*e})}
function Pb(){var a=J.ja;V.ra.Je(1);1!==J.o&&(b.viewport(0,0,3,J.o),z.set("s0"),z.kd("u1",1),W.l(!1,!1),z.kd("u1",0));b.viewport(0,a,1,1);z.set("s52");L.ma&&z.G("u36",oa[a].rz);1!==J.o&&z.G("u35",J.Hb);if(1<J.o){var c=Ob()?0:1;z.G("u43",c)}z.Le("u39",ub.get());W.l(!1,!1);J.Lc&&(b.viewport(1,a,1,1),z.set("s53"),W.l(!1,!1),b.viewport(2,a,1,1),z.set("s54"),W.l(!1,!1))}function yb(){x.L&&x.L.remove();x.Ra=x.element.isFakeVideo?!0:!1;if(x.Ra){var a=zb();a={isFlipY:!1,array:x.element.arrayBuffer,width:a.w,
height:a.na,isKeepArray:!0}}else a={J:x.element};x.Sb=X.instance(Object.assign({isPot:!1,isLinear:!0,isFloat:!1},a));x.L=x.Sb}function Ia(){var a=[{type:"mat2",name:"u32",value:x.u}];z.S("s50",[{type:"1i",name:"u1",value:0}].concat(a));z.S("s51",a)}function Ja(){x.I[0]=.5;x.I[1]=.5;var a=x.D[1]/x.D[0];Qa=Fa.T()/Fa.C();90===Math.abs(ma.rotate)&&(a=1/a);a>Qa?x.I[1]*=Qa/a:x.I[0]*=a/Qa;z.S("s52",[{name:"u44",type:"1f",value:Qa}]);x.u[0]=0;x.u[1]=0;x.u[2]=0;x.u[3]=0;switch(ma.rotate){case 0:x.u[0]=x.I[0];
x.u[3]=x.I[1];break;case 180:x.u[0]=-x.I[0];x.u[3]=-x.I[1];break;case 90:x.u[1]=x.I[0];x.u[2]=-x.I[1];break;case -90:x.u[1]=-x.I[0],x.u[2]=x.I[1]}ma.flipX&&(x.u[0]*=-1,x.u[2]*=-1);x.Sa||(x.u[1]*=-1,x.u[3]*=-1)}function zb(){var a={w:x.element.videoWidth||x.element.width,na:x.element.videoHeight||x.element.height};if(!a.w||!a.na||4>a.w||4>a.na)throw Error("INVALID VIDEO DIMENSIONS - width = "+a.w+" height = "+a.na);return a}function jb(){var a=zb(),c=x.D[0]!==a.w||x.D[1]!==a.na;c&&(x.D[0]=a.w,x.D[1]=
a.na);return c}function Ya(a,c){if(ia===da.error)return!1;x.element=a;jb();c&&c();return!0}function Ab(a,c,e){a&&a();x.ya={video:{facingMode:{exact:ma.facingMode},width:{min:ma.minWidth,max:ma.maxWidth,ideal:ma.idealWidth},height:{min:ma.minHeight,max:ma.maxHeight,ideal:ma.idealHeight}},audio:!1};ma.deviceId&&(x.ya.deviceId=ma.deviceId);T.get(x.element?x.element:T.ie(),function(f){c&&c(f);e(f)},function(){Ha("WEBCAM_UNAVAILABLE")},x.ya)}function Ha(a){ia!==da.error&&(ia=da.error,L.xa&&L.xa(a))}var ta=
{Uf:function(a){return Math.ceil(Math.log2(a))},kg:function(a){return Math.log2(a)},hg:function(a){return 0===Math.log2(a)%1},gf:function(a){var c=[0,0,0,0];a.forEach(function(e){c[0]+=e[0];c[1]+=e[1];c[2]+=e[2];c[3]+=e[3]});return c},hf:function(a,c,e){return Math.min(Math.max(a,c),e)},lf:function(a){return a*Math.PI/180},pg:function(a,c){c=Math.pow(10,c);return Math.round(a*c)/c},qg:function(a){return Math.round(1E6*a)/1E6},Vf:function(a,c){return(100*a/c).toFixed(3)},W:function(a,c,e){return a*
(1-e)+c*e},Qd:function(a,c){return ta.Hd(a-c)},Hd:function(a){for(;a>Math.PI;)a-=2*Math.PI;for(;a<=-Math.PI;)a+=2*Math.PI;return a},pf:function(a,c){return Math.abs(ta.Qd(a,c))},Ze:function(a,c){return Math.atan2(Math.sin(a)+Math.sin(c),Math.cos(a)+Math.cos(c))}},wb={get:function(a,c,e){var f=new XMLHttpRequest;f.open("GET",a,!0);f.withCredentials=!1;f.onreadystatechange=function(){4===f.readyState&&(200===f.status||0===f.status?c(f.responseText):"undefined"!==typeof e&&e(f.status))};f.send()},Rf:function(a,
c){wb.get(a,function(e){c(JSON.parse(e))})},mg:function(a,c,e){var f=new XMLHttpRequest;f.open("POST",a,!0);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.onreadystatechange=function(){4!==f.readyState||200!==f.status&&0!==f.status||e(f.responseText)};f.send(c)},Gf:function(a,c){var e=new XMLHttpRequest;e.open("POST",a,!0);e.responseType="arraybuffer";e.onload=function(){c(e.response)};e.send()}},kb={mb:function(a,c){if(0===c||"object"!==typeof a)return a;a=Object.assign({},
a);c=void 0===c||-1===c?-1:c-1;for(var e in a)a[e]=kb.mb(a[e],c);return a}},Xa={Bg:function(a,c,e){a=Math.min(Math.max((e-a)/(c-a),0),1);return a*a*(3-2*a)},Wa:function(a,c,e){return Math.min(Math.max((e-a)/(c-a),0),1)},Af:function(a,c,e,f){return Math.pow(Math.min(Math.max((f-a)/(c-a),0),1),e)},Fg:function(){return 0},lg:function(){return 1},jg:function(a){return a},xf:function(a){return a*a},Cf:function(a){return a*(2-a)},uf:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},sf:function(a){return a*a*a},
Bf:function(a){return--a*a*a+1},tf:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},yf:function(a){return a*a*a*a},Df:function(a){return 1- --a*a*a*a},vf:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},zf:function(a){return a*a*a*a*a},Ef:function(a){return 1+--a*a*a*a*a},wf:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}},Qb={Wd:function(a,c,e){switch(a){case "relu":return e+"=max(vec4(0.,0.,0.,0.),"+c+");";case "elu":return e+"=mix(exp(-abs("+c+"))-vec4(1.,1.,1.,1.),"+c+",step(0.,"+
c+"));";case "elu01":return e+"=mix(0.1*exp(-abs("+c+"))-vec4(0.1,0.1,0.1,0.1),"+c+",step(0.,"+c+"));";case "arctan":return e+"=atan(3.14159265359*texture2D(u0,vUV))/3.14159265359;";case "copy":return"";default:return!1}}},z=function(){function a(t,n,A){n=t.createShader(n);t.shaderSource(n,A);t.compileShader(n);return t.getShaderParameter(n,t.COMPILE_STATUS)?n:!1}function c(t,n,A){n=a(t,t.VERTEX_SHADER,n);A=a(t,t.FRAGMENT_SHADER,A);t===b&&r.push(n,A);var N=t.createProgram();t.attachShader(N,n);t.attachShader(N,
A);t.linkProgram(N);return N}function e(t,n){void 0===n.la&&(n.la="precision lowp float;attribute vec2 a0;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=a0*.5+vec2(.5,.5);}");void 0===n.Ga&&(n.Ga=["a0"]);void 0===n.ua&&(n.ua=[2]);if(void 0===n.precision||"highp"===n.precision)n.precision=v;n.id=w++;void 0!==n.gd&&(n.gd.forEach(function(N,D){n.g=n.g.replace(N,n.eb[D])}),n.gd.splice(0));n.Yb=0;n.ua.forEach(function(N){n.Yb+=4*N});n.ka=c(t,n.la,"precision "+n.precision+" float;\n"+n.g);
n.v={};n.i.forEach(function(N){n.v[N]=t.getUniformLocation(n.ka,N)});n.attributes={};n.va=[];n.Ga.forEach(function(N){var D=t.getAttribLocation(n.ka,N);n.attributes[N]=D;n.va.push(D)});if(n.j){t.useProgram(n.ka);h=n;l=n.id;for(var A in n.j)t.uniform1i(n.v[A],n.j[A])}n.Db=!0}function f(t){va.Ke(I);l!==t.id&&(I.O(),l=t.id,h=t,b.useProgram(t.ka),t.va.forEach(function(n){0!==n&&b.enableVertexAttribArray(n)}))}function k(t,n,A){e(t,n,A);t.useProgram(n.ka);t.enableVertexAttribArray(0);l=-1;return h=n}function g(){return{g:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",
i:["u1"],j:{u1:0}}}var r=[],l=-1,h=null,w=0,y=!1,v="highp",d=["u1"],u=["u0"],B={u1:0},E={u0:0},q={u1:0,u2:1},G={u3:0},U={s0:g(),s1:{g:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:d,j:B,precision:"lowp"},s2:{g:"uniform sampler2D u1,u2;varying vec2 vv0;void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a*b;}",i:["u1","u2"],j:q},s3:{g:"uniform sampler2D u1;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a.r*f;}",
i:d,j:B},s4:{g:"uniform sampler2D u1,u2;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a.a*b.r*f;}",i:["u1","u2"],j:q},s5:{g:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(1.-vv0.x,vv0.y));}",i:d,j:B},s6:{g:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(vv0.x,1.-vv0.y));}",i:d,j:B},s7:{g:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=a*u4;}",
i:["u0","u4"],j:E},s8:{g:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;const vec4 f=vec4(.25,.25,.25,.25),g=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);float b=dot(a*u4,f);gl_FragColor=b*g;}",i:["u0","u4"],j:E},s9:{g:"uniform sampler2D u1;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){float a=.25*dot(e,texture2D(u1,vv0));gl_FragColor=a*e;}",i:d,j:B},s10:{g:"uniform sampler2D u1,u5;uniform float u6;const vec4 f=vec4(1.,1.,1.,1.);varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0),b=texture2D(u5,vv0);gl_FragColor=mix(b,a,u6*f);}",
i:["u1","u5","u6"],j:{u1:0,u5:1}},s11:{g:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;void main(){gl_FragColor=.25*(texture2D(u1,vv0+u7)+texture2D(u1,vv0+u7*vec2(1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,1.)));}",i:["u1","u7"],j:B},s12:{g:"uniform sampler2D u1;uniform vec4 u8;varying vec2 vv0;float g(float a,float b){a=floor(a)+.5;return floor(a/exp2(b));}float h(float a,float b){return floor(a*exp2(b)+.5);}float i(float a,float b){return mod(a,h(1.,b));}float e(float c,float a,float b){a=floor(a+.5),b=floor(b+.5);return i(g(c,a),b-a);}vec4 j(float a){if(a==0.)return vec4(0.,0.,0.,0.);float k=128.*step(a,0.);a=abs(a);float c=floor(log2(a)),l=c+127.,b=(a/exp2(c)-1.)*8388608.,d=l/2.,m=fract(d)*2.,n=floor(d),o=e(b,0.,8.),p=e(b,8.,16.),q=m*128.+e(b,16.,23.),r=k+n;return vec4(o,p,q,r)/255.;}void main(){float a=dot(texture2D(u1,vv0),u8);gl_FragColor=j(a);}",
i:["u1","u8"],j:B},s13:{g:"uniform sampler2D u0;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=e/(e+exp(-a));gl_FragColor=b;}",i:u,j:E},s14:{g:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(0.,0.,0.,0.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=max(f,a);}",i:u,j:E},s15:{g:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=mix(exp(-abs(a))-f,a,step(0.,a));}",i:u,j:E},s16:{g:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=exp(-abs(a))-f;gl_FragColor=mix(.1*b,a,step(0.,a));}",
i:u,j:E},s17:{g:"uniform sampler2D u0,u6,u9;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),c=texture2D(u6,vv0),d=texture2D(u9,vv0),b=a/d;gl_FragColor=c*mix(exp(-abs(b))-f,b,step(0.,a));}",i:["u0","u6","u9"],j:{u0:0,u6:1,u9:2}},s18:{g:"uniform sampler2D u0;const float e=3.141593;varying vec2 vv0;void main(){gl_FragColor=atan(e*texture2D(u0,vv0))/e;}",i:u,j:E},s19:{g:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=log(f+a);gl_FragColor=b;}",
i:u,j:E},s20:{g:"uniform sampler2D u0,u10;uniform float u11;const vec2 e=vec2(.5,.5);const float f=1e-5;const vec4 g=vec4(1.,1.,1.,1.),i=vec4(0.,0.,0.,0.);varying vec2 vv0;void main(){vec4 a=texture2D(u10,e);float b=u11*u11;vec4 c=max(b*a,f*g);gl_FragColor=texture2D(u0,vv0)/c;}",i:["u0","u10","u11"],j:{u0:0,u10:1}},s21:{g:"uniform sampler2D u1;uniform vec2 u12;varying vec2 vv0;void main(){float a=u12.x*u12.y;vec2 b=floor(vv0*a)/a,c=fract(vv0*a),d=floor(b*u12.y),f=floor(u12.x*fract(b*u12.y)),g=(f*u12.y+d)/a;gl_FragColor=texture2D(u1,g+c/a);}",
i:["u1","u12"],j:B},s22:{g:"uniform sampler2D u13,u14,u15;varying vec2 vv0;void main(){vec4 a=texture2D(u15,vv0);vec2 b=a.rg,c=a.ba;vec4 d=texture2D(u13,b),f=texture2D(u14,c);gl_FragColor=d*f;}",i:["u13","u14","u15"],j:{u14:0,u13:1,u15:2}},s23:{g:"uniform float u16;uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec2 a=fract(vv0*u16);vec4 b=texture2D(u13,vv0),c=texture2D(u14,a);gl_FragColor=b*c;}",i:["u14","u13","u16"],j:{u14:0,u13:1}},s24:{g:"uniform float u16;uniform sampler2D u13,u14,u17,u18,u19,u20;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.),g=vec4(1e-3,1e-3,1e-3,1e-3);void main(){vec2 h=vv0*u16,l=floor(h),c=h-l;vec4 m=texture2D(u13,vv0),d=texture2D(u14,c),a=texture2D(u20,vv0);a=a*255.;vec4 n=texture2D(u17,c),o=texture2D(u18,c),p=texture2D(u19,c),i=step(-g,-a),b=e-i,j=b*step(-e-g,-a);b*=e-j;vec4 k=b*step(-2.*e-g,-a);b*=e-k;vec4 q=b;d=i*d+j*n+k*o+q*p,gl_FragColor=m*d;}",
i:"u13 u14 u16 u20 u17 u18 u19".split(" "),j:{u14:0,u13:1,u20:3,u17:4,u18:5,u19:6}},s25:{g:"uniform sampler2D u13,u14,u21;uniform float u16,u22,u23,u24;varying vec2 vv0;const vec2 j=vec2(1.,1.);void main(){vec2 a=floor(u22*vv0),b=u22*vv0-a;float c=u16/u22;vec2 d=floor(b*c),f=b*c-d,g=(a+f)/u22;float k=u22*u24/u16;vec2 l=k*d,h=(l+f*u23)/u24,i=step(h,j);vec4 m=texture2D(u13,g),n=texture2D(u14,h),o=m*n*i.x*i.y,p=texture2D(u21,g);gl_FragColor=o*u23*u23+p;}",i:"u13 u14 u16 u22 u23 u24 u21".split(" "),j:{u14:0,
u13:1,u21:2}},s26:{g:"uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec4 a=texture2D(u13,vv0),b=texture2D(u14,vv0);gl_FragColor=a*b;}",i:["u13","u14"],j:{u14:0,u13:1}},s27:{g:"uniform sampler2D u1,u21;uniform float u25;varying vec2 vv0;void main(){gl_FragColor=texture2D(u21,vv0)+u25*texture2D(u1,vv0);}",i:["u1","u21","u25"],j:{u1:0,u21:1}},s28:{g:"varying vec2 vv0;uniform sampler2D u1;const vec4 f=vec4(1.,1.,1.,1.),g=vec4(.299,.587,.114,0.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=dot(a,g)*f;}",
i:d,j:B,precision:"lowp"},s29:{g:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(dot(a,f),dot(b,f),dot(c,f),dot(d,f));}",i:["u1","u26"],j:B,precision:"lowp"},s30:{g:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(a.r,b.g,c.b,dot(d,f));}",
i:["u1","u26"],j:B,precision:"lowp"},s31:{g:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=vec4(0.);a-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y))*2.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y))*2.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec4 b=vec4(0.);b-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,b-=texture2D(u1,vec2(vv0.x,vv0.y-u27))*2.,b-=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,b+=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,b+=texture2D(u1,vec2(vv0.x,vv0.y+u27))*2.,b+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec3 c=sqrt(a.rgb*a.rgb+b.rgb*b.rgb);vec4 e=vec4(c,texture2D(u1,vv0).a),g=texture2D(u2,vv0);gl_FragColor=g.a*e.r*f;}",
i:["u1","u2","u27"],j:q},s32:{g:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 j=vec4(1.,1.,1.,1.);const vec2 k=vec2(1.,1.);void main(){float h=0.;vec2 l=k*u27,a,b;float c,d,i=0.;for(float e=-4.;e<=4.;e+=1.)for(float f=-4.;f<=4.;f+=1.)a=vec2(e,f),c=length(a)/2.,d=exp(-c*c),b=vv0+l*a,h+=d*texture2D(u1,b).r,i+=d;vec4 m=texture2D(u2,vv0);gl_FragColor=m.a*(texture2D(u1,b).r-h/i)*j;}",i:["u1","u2","u27"],j:q},s33:{g:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}const vec2 g=vec2(.5,.5),h=vec2(1.,0.),i=vec2(0.,1.);void main(){vec2 a=vv0-u7*g;vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*h),d=texture2D(u3,a+u7*i),j=texture2D(u3,a+u7),k=e(b,c),l=e(d,j);gl_FragColor=e(k,l);}",
i:["u3","u7"],j:G},s34:{g:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;const vec2 k=vec2(1.,0.),l=vec2(0.,1.),m=vec2(2.,0.),n=vec2(0.,2.);vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}vec4 f(vec2 a){vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*k),d=texture2D(u3,a+u7*l),g=texture2D(u3,a+u7),h=e(b,c),i=e(d,g);return e(h,i);}void main(){vec2 a=vv0+u7*vec2(-.55,-1.05);vec4 b=f(a),c=f(a+u7*m),d=f(a+u7*2.),g=f(a+u7*n),h=e(b,c),i=e(d,g);gl_FragColor=e(h,i);}",i:["u3","u7"],j:G},s35:{g:"uniform sampler2D u1;varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a*a;}",
i:["u1"],j:B,precision:"lowp"},s36:{g:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const float e=15444.;void main(){vec4 a=1001./e*texture2D(u1,vv0-3.*u7)+2002./e*texture2D(u1,vv0-2.*u7)+3003./e*texture2D(u1,vv0-u7)+3432./e*texture2D(u1,vv0)+3003./e*texture2D(u1,vv0+u7)+2002./e*texture2D(u1,vv0+2.*u7)+1001./e*texture2D(u1,vv0+3.*u7);gl_FragColor=a;}",i:["u7","u1"],j:B,precision:"lowp"},s37:{g:"uniform sampler2D u1,u28,u29;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);const float g=.1;void main(){vec4 a=texture2D(u28,vv0),b=texture2D(u29,vv0),c=texture2D(u1,vv0),d=max(f*g,b-a*a),h=sqrt(d);gl_FragColor=(c-a)/h;}",
i:["u1","u28","u29"],j:{u1:0,u28:1,u29:2}}},O={s38:{g:"uniform float u16,u30;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-5,1e-5);void main(){vec4 sum=texture2D(u21,vv0);float toSparsity=1.1111;vec2 uvFrom,uvWeight,xyPatch=ZERO2,eps2=EPS2/u16,xyTo=floor(vv0*u16+eps2);float weightSize=toSparsity*u16;vec2 halfFromSparsity=ONE2*(toSparsity-1.)/2.;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.)xyPatch.y=patch_y,uvFrom=(xyTo+HALF2+u30*(xyPatch-halfFromSparsity))/u16,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),uvWeight=(xyTo*toSparsity+xyPatch+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}gl_FragColor=sum,gl_FragColor*=2.2222;}",
i:["u16","u13","u14","u21","u30"],eb:["1.1111","gl_FragColor\\*=2.2222;"]},s39:{g:"uniform float u16,u30,u24;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-4,1e-4);void main(){vec4 sum=texture2D(u21,vv0);float fromSparsity=1.1111,shrinkFactor=3.3333;vec2 uvFrom,uvWeight,xyFrom,xyPatchTo,xyPatch=ZERO2,xyShrink=ZERO2,eps2=EPS2/u24,xyTo=floor(vv0*u16+eps2);float weightSize=fromSparsity*u24;vec2 halfFromSparsity=ONE2*(fromSparsity-1.)/2.;float toSparsity=weightSize/u16;vec2 xyFrom0=xyTo*shrinkFactor;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.){xyPatch.y=patch_y;for(float shrink_x=0.;shrink_x<3.3333;shrink_x+=1.){xyShrink.x=shrink_x;for(float shrink_y=0.;shrink_y<3.3333;shrink_y+=1.)xyShrink.y=shrink_y,xyFrom=xyFrom0+xyShrink+shrinkFactor*u30*(xyPatch-halfFromSparsity),uvFrom=(xyFrom+HALF2)/u24,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),xyPatchTo=xyPatch*shrinkFactor+xyShrink,uvWeight=(xyTo*toSparsity+xyPatchTo+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}}}gl_FragColor=sum,gl_FragColor*=2.2222;}",
i:"u16 u24 u13 u14 u21 u30".split(" "),eb:["1.1111","gl_FragColor\\*=2.2222;","3.3333"]}},R=null,F=null,I={Ua:function(){return y},B:function(){if(!y){R=kb.mb(U,2);F=kb.mb(O,2);v="highp";for(var t in R)e(b,R[t],t);z.set("s0");b.enableVertexAttribArray(0);y=!0}},sd:function(t){t.forEach(function(n){I.ac(n)})},ac:function(t){R[t.id]=t;e(b,t,t.id)},Ec:function(t,n,A){n||(n=t);R[n]=Object.create(F[t]);R[n].pe=!0;F[t].eb&&F[t].eb.forEach(function(N,D){R[n].g=R[n].g.replace(new RegExp(N,"g"),A[D])});e(b,
R[n],n)},set:function(t){f(R[t])},Da:function(t){return k(t,g(),"s40")},Pb:function(t){return k(t,{g:"void main(){gl_FragColor=vec4(.5,.5,.5,.5);}",i:[],precision:"highp"},"s41")},Td:function(t){return"undefined"===typeof R[t]?!1:R[t].Db},O:function(){-1!==l&&(l=-1,h.va.forEach(function(t){0!==t&&b.disableVertexAttribArray(t)}))},Rb:function(){var t=0;h.va.forEach(function(n,A){A=h.ua[A];b.vertexAttribPointer(n,A,b.FLOAT,!1,h.Yb,t);t+=4*A})},nc:function(){b.enableVertexAttribArray(0)},pa:function(){I.fb(b)},
fb:function(t){t.vertexAttribPointer(h.va[0],2,t.FLOAT,!1,8,0)},kd:function(t,n){b.uniform1i(h.v[t],n)},G:function(t,n){b.uniform1f(h.v[t],n)},Ea:function(t,n,A){b.uniform2f(h.v[t],n,A)},vg:function(t,n){b.uniform2fv(h.v[t],n)},Le:function(t,n){b.uniform3fv(h.v[t],n)},wg:function(t,n,A,N){b.uniform3f(h.v[t],n,A,N)},xg:function(t,n,A,N,D){b.uniform4f(h.v[t],n,A,N,D)},Qb:function(t,n){b.uniform4fv(h.v[t],n)},yg:function(t,n){b.uniformMatrix2fv(h.v[t],!1,n)},zg:function(t,n){b.uniformMatrix3fv(h.v[t],
!1,n)},Ag:function(t,n){b.uniformMatrix4fv(h.v[t],!1,n)},S:function(t,n){I.set(t);n.forEach(function(A){switch(A.type){case "4f":b.uniform4fv(h.v[A.name],A.value);break;case "3f":b.uniform3fv(h.v[A.name],A.value);break;case "2f":b.uniform2fv(h.v[A.name],A.value);break;case "1f":b.uniform1f(h.v[A.name],A.value);break;case "1i":b.uniform1i(h.v[A.name],A.value);break;case "mat2":b.uniformMatrix2fv(h.v[A.name],!1,A.value);break;case "mat3":b.uniformMatrix3fv(h.v[A.name],!1,A.value);break;case "mat4":b.uniformMatrix4fv(h.v[A.name],
!1,A.value)}})},Tf:function(){return"lowp"},m:function(){b.disableVertexAttribArray(0);I.O();for(var t in R){var n=R[t];n.Db&&(n.Db=!1,b.deleteProgram(n.ka));n.pe&&delete R[t]}r.forEach(function(A){b.deleteShader(A)});r.splice(0);w=0;y=!1;h=null;l=-1}};return I}(),b=null,Fa=function(){function a(d){console.log("ERROR in ContextFF: ",d);return!1}function c(d){function u(){Ba.m();ba.reset();E.getExtension("WEBGL_lose_context").loseContext()}if(navigator.userAgent&&-1!==navigator.userAgent.indexOf("forceWebGL1"))return!1;
var B=document.createElement("canvas");B.setAttribute("width",5);B.setAttribute("height",5);var E=null;try{E=B.getContext("webgl2",d)}catch(q){return!1}if(!E)return!1;e(E);ba.oc(E);d=ba.nb(E);if(!d.ca&&!d.da)return u(),!1;d=Ba.ec(E,d);u();return d?!0:!1}function e(d){d.clearColor(0,0,0,0);d.disable(d.DEPTH_TEST);d.disable(d.BLEND);d.disable(d.DITHER);d.disable(d.STENCIL_TEST);d.disable(d.CULL_FACE);d.GENERATE_MIPMAP_HINT&&d.hint(d.GENERATE_MIPMAP_HINT,d.FASTEST);d.disable(d.SAMPLE_ALPHA_TO_COVERAGE);
d.disable(d.SAMPLE_COVERAGE);d.depthFunc(d.LEQUAL);d.clearDepth(1)}var f=null,k=null,g=null,r=null,l=null,h=!0,w=null,y=null,v={C:function(){return f.width},T:function(){return f.height},Kf:function(){return f},If:function(){return b},ea:function(){return h},flush:function(){b.flush()},Zd:function(){w||(w=new Uint8Array(f.width*f.height*4));b.readPixels(0,0,f.width,f.height,b.RGBA,b.UNSIGNED_BYTE,w);return w},Mf:function(){return f.toDataURL("image/jpeg")},Nf:function(){sa.N();k||(k=document.createElement("canvas"),
g=k.getContext("2d"));k.width=f.width;k.height=f.height;for(var d=v.Zd(),u=g.createImageData(k.width,k.height),B=k.width,E=k.height,q=u.data,G=0;G<E;++G)for(var U=E-G-1,O=0;O<B;++O){var R=4*(G*B+O),F=4*(U*B+O);q[R]=d[F];q[R+1]=d[F+1];q[R+2]=d[F+2];q[R+3]=d[F+3]}g.putImageData(u,0,0);return k.toDataURL("image/png")},Lf:function(d){!k&&d&&(k=document.createElement("canvas"),g=k.getContext("2d"));var u=d?k:document.createElement("canvas");u.width=f.width;u.height=f.height;(d?g:u.getContext("2d")).drawImage(f,
0,0);return u},B:function(d){d.Ld&&!d.lb?f=document.getElementById(d.Ld):d.lb&&(f=d.lb);f||(f=document.createElement("canvas"));f.width=d&&void 0!==d.width?d.width:512;f.height=d&&void 0!==d.height?d.height:512;"undefined"===typeof d&&(d={});void 0===d.premultipliedAlpha&&(d.premultipliedAlpha=!1);void 0===d.Ic&&(d.Ic=!0);void 0===d.antialias&&(d.antialias=!1);if(b)h=b instanceof WebGL2RenderingContext;else{h=!0;var u={antialias:d.antialias,alpha:!0,preserveDrawingBuffer:!0,premultipliedAlpha:d.premultipliedAlpha,
stencil:!1,depth:d.Ic};navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("noAntialiasing")&&(u.antialias=!1);var B=c(u);!B&&u.antialias&&(u.antialias=!1,B=c(u));B&&(b=f.getContext("webgl2",u));b?h=!0:((b=f.getContext("webgl",u))||(b=f.getContext("experimental-webgl",u)),h=!1)}if(!b)return a("WebGL1 and 2 are not enabled");(r=b.getExtension("WEBGL_lose_context"))&&d.Xc&&(y=d.Xc,f.addEventListener("webglcontextlost",y,!1));if(!ba.B())return a("Not enough GL capabilities");e(b);z.B();
W.B();return Ba.ec(b,ba.Yd())?!0:a("Cannot filter float textures")},cd:function(d,u,B,E,q){if(!ba.Dd())return b.readPixels(d,u,B,E,b.RGBA,b.UNSIGNED_BYTE,q),Promise.resolve();var G=b.PIXEL_PACK_BUFFER;null===l?(l=b.createBuffer(),b.bindBuffer(G,l),b.bufferData(G,q.byteLength,b.STREAM_READ)):b.bindBuffer(G,l);b.readPixels(d,u,B,E,b.RGBA,b.UNSIGNED_BYTE,0);var U=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);b.flush();return new Promise(function(O,R){function F(){switch(b.clientWaitSync(U,0,0)){case b.TIMEOUT_EXPIRED:return;
case b.WAIT_FAILED:null!==I&&clearInterval(I);R();return;default:null!==I&&clearInterval(I),b.deleteSync(U),b.getBufferSubData(G,0,q),b.bindBuffer(G,null),O()}return!0}var I=null;F()||(I=setInterval(F,0))})},m:function(){b&&(ba.m(),Ba.m());r&&y&&(f.removeEventListener("webglcontextlost",y,!1),r=y=null);null!==l&&(b.deleteBuffer(l),l=null);b=w=g=k=f=null}};return v}(),va=function(){function a(){null===c&&("undefined"!==typeof z?c=z:"undefined"!==typeof JEShaders&&(c=JEShaders))}var c=null;a();return{Ke:function(e){c!==
e&&(c&&c.O(),c=e)},Ua:function(){return c.Ua()},pa:function(){return c.pa()},fb:function(e){return c.fb(e)},Rb:function(){return c.Rb()},O:function(){return c.O()},set:function(e){return c.set(e)},Da:function(e){a();return c.Da(e)},Pb:function(e){a();return c.Pb(e)},m:function(){return c.m()}}}(),za=function(){function a(m){b.bindTexture(b.TEXTURE_2D,m)}function c(m){n[0]=m;m=A[0];var K=m>>16&32768,H=m>>12&2047,p=m>>23&255;return 103>p?K:142<p?K|31744|((255==p?0:1)&&m&8388607):113>p?(H|=2048,K|(H>>
114-p)+(H>>113-p&1)):K=(K|p-112<<10|H>>1)+(H&1)}function e(m){var K=new Uint16Array(m.length);m.forEach(function(H,p){K[p]=c(H)});return K}function f(){if(null!==N.Ab)return N.Ab;var m=g(e([.5,.5,.5,.5]));return null===m?!0:N.Ab=m}function k(){if(null!==N.Bb)return N.Bb;var m=g(new Uint8Array([127,127,127,127]));return null===m?!0:N.Bb=m}function g(m){if(!va.Ua()||!E)return null;var K=null,H=Math.sqrt(m.length/4);try{var p=b.getError();if("FUCKING_BIG_ERROR"===p)return!1;K=D.instance({isFloat:!1,
R:!0,array:m,width:H});p=b.getError();if(p!==b.NO_ERROR)return!1}catch(pa){return!1}ka.N();b.viewport(0,0,H,H);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);va.set("s0");K.cc(0);la.l(!0,!0);m=4*H*H;p=new Uint8Array(m);b.readPixels(0,0,H,H,b.RGBA,b.UNSIGNED_BYTE,p);H=!0;for(var ca=0;ca<m;++ca)H=H&&3>Math.abs(p[ca]-127);K.remove();ka.aa();return H}var r=0,l=null,h=0,w=null,y=null,v=null,d=null,u=null,B=null,E=!1,q=[],G={isFloat:!1,isPot:!0,isLinear:!1,isMipmap:!1,isAnisotropicFiltering:!1,isMirrorX:!1,
isMirrorY:!1,isSrgb:!1,isKeepArray:!1,isFlipY:null,width:0,height:0,url:null,array:null,data:null,J:null,zb:null,oe:!1,R:!1,ia:null,Ya:4,Eb:0},U=!1,O=null,R=null,F=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],I=!1,t=!1,n=new Float32Array(1),A=new Int32Array(n.buffer),N={Ab:null,Bb:null},D={B:function(){E||(u=[b.RGBA,null,b.RGBA,b.RGBA],B=[b.RGBA,null,b.RGBA,b.RGBA],l=[b.TEXTURE0,b.TEXTURE1,b.TEXTURE2,b.TEXTURE3,b.TEXTURE4,b.TEXTURE5,b.TEXTURE6,b.TEXTURE7],I="undefined"!==typeof JEContext,t="undefined"!==
typeof ba,I&&JEContext.ig()&&l.push(b.TEXTURE8,b.TEXTURE9),w=[-1,-1,-1,-1,-1,-1,-1,-1],d=[b.UNSIGNED_BYTE,b.FLOAT,b.FLOAT],E=!0)},ke:function(){if(!y){for(var m=new Float32Array(16384),K=0;16384>K;++K)m[K]=2*Math.random()-1;y={random:D.instance({isFloat:!0,isPot:!0,array:m,width:64}),pd:D.instance({isFloat:!1,isPot:!0,width:1,array:new Uint8Array([0,0,0,0])})}}D.Xe()},$f:function(){return y.pd},Xe:function(){d[1]=ba.xb(b)},He:function(){B=u=[b.RGBA,b.RGBA,b.RGBA,b.RGBA]},dd:function(m){z.set("s1");
ka.N();var K=m.C(),H=m.T();b.viewport(0,0,K,H);m.h(0);la.l(!1,!1)},ng:function(m,K){D.dd(m);b.readPixels(0,0,m.C(),m.T(),b.RGBA,b.UNSIGNED_BYTE,K)},og:function(m,K){D.dd(m);return Fa.cd(0,0,m.C(),m.T(),K)},wc:function(m,K,H,p,ca,pa,Ca){m.activeTexture(m.TEXTURE0);var qa=m.createTexture();m.bindTexture(m.TEXTURE_2D,qa);ca=ca instanceof Float32Array?ca:new Float32Array(ca);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,
m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,pa);m.texImage2D(m.TEXTURE_2D,0,m.RGBA,H,p,0,m.RGBA,m.FLOAT,ca);m.bindTexture(m.TEXTURE_2D,null);m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1);Ca&&(ka.aa(),z.Da(m));m.viewport(0,0,H,p);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,K,0);m.bindTexture(m.TEXTURE_2D,qa);Ca?la.l(!0,!0):W.Na(m);m.deleteTexture(qa);E&&(w[0]=-1,v=null,r=0)},ib:function(m){m!==
r&&(b.activeTexture(l[m]),r=m)},instance:function(m){function K(C){var M=b.getError();if("FUCKING_BIG_ERROR"===M)return!1;b.texImage2D(b.TEXTURE_2D,0,fa,ea,ha,C);M=b.getError();M!==b.NO_ERROR&&ea!==b.RGBA&&(ea=b.RGBA,b.texImage2D(b.TEXTURE_2D,0,fa,ea,ha,C));return!0}function H(){if(!Bb){a(ra);wa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,wa);p.isPot?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,p.isMirrorX?b.MIRRORED_REPEAT:b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,p.isMirrorY?b.MIRRORED_REPEAT:
b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE));p.isAnisotropicFiltering&&"undefined"!==typeof JESETTINGS&&b.texParameterf(b.TEXTURE_2D,JEContext.Of().TEXTURE_MAX_ANISOTROPY_EXT,JESETTINGS.$e);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,p.isLinear?b.LINEAR:b.NEAREST);p.isLinear?b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p.isMipmap&&!Ka?b.NEAREST_MIPMAP_LINEAR:b.LINEAR):b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,p.isMipmap&&!Ka?b.NEAREST_MIPMAP_NEAREST:b.NEAREST);ea=u[p.Ya-1];fa=B[p.Ya-1];ha=d[pa];if(ba.ea()){var C=ba.ae();ea===b.RGBA&&ha===b.FLOAT?p.isMipmap||p.isLinear?fa=Ba.ce(b):ba.fc()?C&&(fa=C):fa=b.RGBA16F||b.RGBA:ea===b.RGB&&ha===b.FLOAT&&C&&(fa=C,ea=b.RGBA)}if(p.R&&!p.isFloat||p.isFloat&&p.isMipmap&&Ba.te())fa=ba.be(),ha=ba.xb(b);p.Eb&&(Za=p.Eb);p.isSrgb&&4===p.Ya&&(ea=JEContext.Yf());if(p.J)K(p.J);else if(p.url)K(Ga);else if(xa){C=xa;try{"FUCKING_BIG_ERROR"!==b.getError()&&
(b.texImage2D(b.TEXTURE_2D,0,fa,P,Q,0,ea,ha,C),b.getError()!==b.NO_ERROR&&(b.texImage2D(b.TEXTURE_2D,0,fa,P,Q,0,ea,ha,null),b.getError()!==b.NO_ERROR&&b.texImage2D(b.TEXTURE_2D,0,b.RGBA,P,Q,0,b.RGBA,b.UNSIGNED_BYTE,null)))}catch(bc){b.texImage2D(b.TEXTURE_2D,0,fa,P,Q,0,ea,ha,null)}p.isKeepArray||(xa=null)}else C=b.getError(),"FUCKING_BIG_ERROR"!==C&&(b.texImage2D(b.TEXTURE_2D,0,fa,P,Q,0,ea,ha,null),C=b.getError(),C!==b.NO_ERROR&&(ea=b.RGBA,p.R&&ha!==b.FLOAT&&(ha=b.FLOAT,b.texImage2D(b.TEXTURE_2D,
0,fa,P,Q,0,ea,ha,null))));if(p.isMipmap)if(!Ka&&aa)aa.wb(),$a=!0;else if(Ka){C=Math.log2(Math.min(P,Q));Ra=Array(1+C);Ra[0]=ra;for(var M=1;M<=C;++M){var ja=Math.pow(2,M),S=P/ja;ja=Q/ja;var La=b.createTexture();a(La);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,fa,S,ja,0,ea,ha,null);a(null);Ra[M]=La}$a=!0}a(null);w[r]=-1;wa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);Ta=!0;p.ia&&aa&&(p.ia(aa),p.ia=
null)}}var p=Object.assign({},G,m),ca=h++;null===p.isFlipY&&(p.isFlipY=p.url||p.array?!0:!1);p.data&&(p.array="string"===typeof p.data?Ib(p.data):p.isFloat?new Float32Array(p.data):new Uint8Array(p.data),p.isFlipY=!1);var pa=0,Ca=p.J?!0:!1,qa=null,lb=null,Cb=!1,mb=null;p.R=p.R||p.isFloat;p.R&&(pa=1);!p.oe&&p.isFloat&&t&&!ba.fc()&&(p.isFloat=!1);p.isFloat&&(pa=2);p.isAnisotropicFiltering&&I&&!JEContext.cg()&&(p.isAnisotropicFiltering=!1);var ra=p.zb||b.createTexture(),Ga=null,xa=!1,P=0,Q=0,Ta=!1,Bb=
!1,ab=!1,ya=null,Da=null,nb=null,Ua=null,fa=null,ea=null,ha=null,wa=p.isFlipY,Rb=(m=p.R&&p.isMipmap)&&Ba.Cd(),Ka=m&&Rb?!0:!1,Ra=null,Za=-1,$a=!1,Ma={Mc:!1,dc:null,xc:null};p.width&&(P=p.width,Q=p.height?p.height:P);var aa={get:function(){return ra},C:function(){return P},T:function(){return Q},ag:function(){return p.url},dg:function(){return p.isFloat},fg:function(){return p.R},gg:function(){return p.isLinear},wb:function(){b.generateMipmap(b.TEXTURE_2D)},Ad:function(C,M){Ka?(C||(C=aa.Bc()),D.ib(M),
a(Ra[C]),w[M]=-1):aa.h(M)},Bc:function(){-1===Za&&(Za=Math.log(P)/Math.log(2));return Za},Vd:function(C){if(Ka){C||(C=aa.Bc());z.set("s11");D.ib(0);for(var M=P,ja=Q,S=1;S<=C;++S)M/=2,ja/=2,z.Ea("u7",.25/M,.25/ja),b.viewport(0,0,M,ja),a(Ra[S-1]),b.framebufferTexture2D(ka.Qa(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,Ra[S],0),la.l(!1,1===S);w[0]=-1}else aa.wb()},h:function(C){if(!Ta)return!1;D.ib(C);if(w[C]===ca)return!1;a(ra);w[C]=ca;return!0},cc:function(C){b.activeTexture(l[C]);r=C;a(ra);w[C]=ca},A:function(){v=
aa;b.framebufferTexture2D(ka.Qa(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,ra,0)},fa:function(){v=aa;b.viewport(0,0,P,Q);b.framebufferTexture2D(ka.Qa(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,ra,0)},Xb:D.Xb,resize:function(C,M){P=C;Q=M;H()},clone:function(C){C=D.instance({width:P,height:Q,R:p.R,isFloat:p.isFloat,isLinear:p.isLinear,isMirrorY:p.isMirrorY,isFlipY:C?!wa:wa,isPot:p.isPot});va.set("s0");ka.aa();C.A();b.viewport(0,0,P,Q);aa.h(0);la.l(!0,!0);return C},Me:function(){b.viewport(0,0,P,Q)},remove:function(){b.deleteTexture(ra);
Bb=!0;q.splice(q.indexOf(aa),1);aa=null},refresh:function(){aa.cc(0);wa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);Ca?b.texImage2D(b.TEXTURE_2D,0,fa,ea,b.UNSIGNED_BYTE,p.J):b.texImage2D(b.TEXTURE_2D,0,fa,P,Q,0,ea,ha,xa);wa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},lc:function(){var C=P*Q*4;Da=[new Uint8Array(C),new Uint8Array(C),new Uint8Array(C),new Uint8Array(C)];ya=[new Float32Array(Da[0].buffer),new Float32Array(Da[1].buffer),new Float32Array(Da[2].buffer),new Float32Array(Da[3].buffer)];nb=new Uint8Array(4*
C);Ua=new Float32Array(nb.buffer);ab=!0},bd:function(){ab||aa.lc();b.readPixels(0,0,P,4*Q,b.RGBA,b.UNSIGNED_BYTE,nb);for(var C=P*Q,M=2*C,ja=3*C,S=0;S<C;++S)ya[0][S]=Ua[S],ya[1][S]=Ua[S+C],ya[2][S]=Ua[S+M],ya[3][S]=Ua[S+ja];return ya},Ee:function(){Ma.Mc||(Ma.dc=new Uint8Array(P*Q*4),Ma.xc=new Float32Array(Ma.buffer),Ma.Mc=!0);b.readPixels(0,0,P,Q,b.RGBA,b.UNSIGNED_BYTE,Ma.dc);return Ma.xc},mc:function(C){ka.N();z.set("s12");aa.h(0);if(C)b.viewport(0,0,P,Q),z.Qb("u8",.25,.25,.25,.25),la.l(!1,!0);else for(C=
0;4>C;++C)b.viewport(0,Q*C,P,Q),z.Qb("u8",F[C]),la.l(!1,0===C)},We:function(C){var M=ha===d[0]&&!k();a(ra);wa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);M?(Cb||(qa=document.createElement("canvas"),qa.width=P,qa.height=Q,lb=qa.getContext("2d"),mb=lb.createImageData(P,Q),Cb=!0),mb.data.set(C),lb.putImageData(mb,0,0),b.texImage2D(b.TEXTURE_2D,0,fa,ea,ha,qa)):b.texImage2D(b.TEXTURE_2D,0,fa,P,Q,0,ea,ha,C);w[r]=ca;wa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Eg:function(C,M){a(ra);M&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,
!0);b.texImage2D(b.TEXTURE_2D,0,fa,ea,ha,C);w[r]=ca;M&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},tg:function(C,M){var ja=P*Q,S=4*ja;C=p.R?C?"RGBE":"JSON":"RGBA";M&&(C=M);M=ba.ea()&&!1;var La=null;switch(C){case "RGBE":La="s42";break;case "JSON":La=M?"s0":"s12";break;case "RGBA":case "RGBAARRAY":La="s6"}ab||("RGBA"===C||"RGBE"===C||"RGBAARRAY"===C?(Da=new Uint8Array(S),ab=!0):"JSON"!==C||M||aa.lc());ka.N();z.set(La);aa.h(0);S=null;if("RGBA"===C||"RGBE"===C||"RGBAARRAY"===C){b.viewport(0,0,P,Q);la.l(!0,
!0);b.readPixels(0,0,P,Q,b.RGBA,b.UNSIGNED_BYTE,Da);if("RGBAARRAY"===C)return{data:Da};U||(O=document.createElement("canvas"),R=O.getContext("2d"),U=!0);O.width=P;O.height=Q;ja=R.createImageData(P,Q);ja.data.set(Da);R.putImageData(ja,0,0);S=O.toDataURL("image/png")}else if("JSON"===C)if(M)S=new Float32Array(ja),b.viewport(0,0,P,Q),la.l(!0,!0),b.readPixels(0,0,P,Q,b.RGBA,b.FLOAT,S);else{for(S=0;4>S;++S)b.viewport(0,Q*S,P,Q),z.Qb("u8",F[S]),la.l(!S,!S);aa.bd();S=Array(ja);for(M=0;M<ja;++M)S[4*M]=ya[0][M],
S[4*M+1]=ya[1][M],S[4*M+2]=ya[2][M],S[4*M+3]=ya[3][M]}return{format:C,data:S,width:P,height:Q,isMirrorY:p.isMirrorY,isFlipY:"RGBA"===C?p.isFlipY:!p.isFlipY}}};p.isMipmap&&!Ka&&Ta&&!$a&&(aa.wb(),$a=!0);if(p.url)a(ra),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,null),Ga=new Image,Ga.mf="Anonymous",Ga.crossOrigin="Anonymous",Ga.src=p.url,Ga.onload=function(){P=Ga.width;Q=Ga.height;H()};else if(p.J){var Db=function(){P=void 0!==p.J.videoWidth?p.J.videoWidth:p.J.width;Q=void 0!==p.J.videoHeight?
p.J.videoHeight:p.J.height;P?H():setTimeout(Db,1)};Db()}else p.array?(p.R&&!p.isFloat?p.array instanceof Uint16Array?(xa=p.array,H()):f()?(xa=e(p.array),H()):(H(),D.wc(b,ra,aa.C(),aa.T(),p.array,wa,!0)):(xa=p.isFloat?p.array instanceof Float32Array?p.array:new Float32Array(p.array):p.array instanceof Uint8Array?p.array:new Uint8Array(p.array),H()),p.isKeepArray||(xa&&xa!==p.array&&(xa=null),delete p.array)):p.zb?Ta=!0:H();aa.Xf=aa.C;p.ia&&Ta&&(p.ia(aa),p.ia=null);q.push(aa);return aa},N:function(m){m!==
r&&(b.activeTexture(l[m]),r=m);w[m]=-1;a(null)},cf:function(m){y.random.h(m)},Xb:function(){v=null;b.framebufferTexture2D(ka.Qa(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)},reset:function(){0!==r&&b.activeTexture(l[0]);for(var m=0;m<l.length;++m)w[m]=-1;r=-1},rg:function(){r=-1},Te:function(){for(var m=0;m<l.length;++m)D.N(m)},yc:function(){y&&(y.random.remove(),y.pd.remove())},Dg:function(m,K){if("RGBA"===m.format||"RGBE"===m.format){var H=new Image;H.src=m.data;H.onload=function(){D.instance({isMirrorY:m.isMirrorY,
isFlipY:m.isFlipY,isFloat:!1,J:H,ia:function(p){if("RGBA"===m.format)K(p);else{var ca=m.width,pa=m.height,Ca=D.instance({isMirrorY:m.isMirrorY,isFloat:!0,width:ca,height:pa,isFlipY:m.isFlipY});ka.aa();b.viewport(0,0,ca,pa);z.set("s43");Ca.A();p.h(0);la.l(!0,!0);D.N(0);K(Ca);b.flush();setTimeout(p.remove,50)}}})}}else"JSON"===m.format?K(D.instance({isFloat:!0,isFlipY:m.isFlipY,width:m.width,height:m.height,array:new Float32Array(m.data)})):K(!1)},Id:e,m:function(){v&&(sa.aa(),D.Xb(),sa.N());D.Te();
q.slice(0).forEach(function(m){m.remove()});q.splice(0);E=!1;h=0;"undefined"!==typeof Ba&&Ba.m();y=null}};return D}(),Kb=function(){return{instance:function(a){var c=[za.instance(a),za.instance(a)],e=[c[1],c[0]],f=e,k={Je:function(g){f[1].A();f[0].h(g);k.md()},ug:function(g){f[1].fa();f[0].h(g);k.md()},md:function(){f=f===c?e:c},refresh:function(){f[0].refresh();f[1].refresh()},h:function(g){f[0].h(g)},bf:function(g){f[1].h(g)},Sf:function(){return f[0]},remove:function(){f[0].remove();f[1].remove();
f=null}};return k}}}(),la=function(){function a(h){var w={$:null,H:null};w.$=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,w.$);h.bufferData(h.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),h.STATIC_DRAW);w.H=h.createBuffer();h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,w.H);h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2]),h.STATIC_DRAW);return w}var c=null,e=0,f=!1,k=[],g=-2,r=-2,l={reset:function(){r=g=-2},B:function(){f||(c=a(b),l.wa(),f=!0)},instance:function(h){var w=e++,y=h.H?h.H.length:
0,v="undefined"===typeof h.mode?b.STATIC_DRAW:h.mode,d=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,d);b.bufferData(b.ARRAY_BUFFER,h.$ instanceof Float32Array?h.$:new Float32Array(h.$),v);g=w;var u=null,B=null,E=null;if(h.H){u=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,u);var q=null;65536>h.H.length?(q=Uint16Array,B=b.UNSIGNED_SHORT,E=2):(q=Uint32Array,B=b.UNSIGNED_INT,E=4);q=h.H instanceof q?h.H:new q(h.H);b.bufferData(b.ELEMENT_ARRAY_BUFFER,q,v);r=w}var G={Bd:function(U){g!==w&&(b.bindBuffer(b.ARRAY_BUFFER,
d),g=w);U&&va.Rb()},yd:function(){r!==w&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,u),r=w)},bind:function(U){G.Bd(U);G.yd()},qf:function(){b.drawElements(b.TRIANGLES,y,B,0)},rf:function(U,O){b.drawElements(b.TRIANGLES,U,B,O*E)},remove:function(){b.deleteBuffer(d);h.H&&b.deleteBuffer(u);G=null}};k.push(G);return G},wa:function(){-1!==g&&(b.bindBuffer(b.ARRAY_BUFFER,c.$),g=-1);-1!==r&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.H),r=-1)},l:function(h,w){h&&la.wa();w&&va.pa();b.drawElements(b.TRIANGLES,3,b.UNSIGNED_SHORT,
0)},Na:function(h){h=h||b;var w=a(h);h.bindBuffer(h.ARRAY_BUFFER,w.$);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,w.H);va.fb(h);h.clear(h.COLOR_BUFFER_BIT);h.drawElements(h.TRIANGLES,3,h.UNSIGNED_SHORT,0);h.flush();h.bindBuffer(h.ARRAY_BUFFER,null);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null);h.deleteBuffer(w.$);h.deleteBuffer(w.H);l.reset();f&&(l.wa(),va.pa())},yc:function(){var h=b,w=c;h.deleteBuffer(w.$);h.deleteBuffer(w.H)},m:function(){l.yc();k.forEach(function(h){h.remove()});b.bindBuffer(b.ARRAY_BUFFER,
null);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);l.reset();f=!1;k.splice(0);e=0}};return l}(),ka=function(){var a=null,c=null,e=null,f=!1,k=[],g={F:-2,vc:1},r={Ua:function(){return f},B:function(){if(!f){a=b.createFramebuffer();var l=ba.ea();c=l&&b.DRAW_FRAMEBUFFER?b.DRAW_FRAMEBUFFER:b.FRAMEBUFFER;e=l&&b.READ_FRAMEBUFFER?b.READ_FRAMEBUFFER:b.FRAMEBUFFER;f=!0}},Pf:function(){return c},de:function(){return e},Qa:function(){return b.FRAMEBUFFER},Wf:function(){return g},Hf:function(){return a},instance:function(l){void 0===
l.Hc&&(l.Hc=!1);var h=l.L?l.L:null,w=l.width,y=void 0!==l.height?l.height:l.width,v=a,d=null,u=!1,B=!1,E=0;h&&(w=w?w:h.C(),y=y?y:h.T());var q={hd:function(){u||(v=b.createFramebuffer(),u=!0,E=g.vc++)},rd:function(){q.hd();q.A();d=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,d);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,w,y);b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,d);b.clearDepth(1)},bind:function(G,U){E!==g.F&&(b.bindFramebuffer(c,v),g.F=E);h&&h.A();
U&&b.viewport(0,0,w,y);G&&b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},af:function(){E!==g.F&&(b.bindFramebuffer(c,v),g.F=E)},clear:function(){b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},jf:function(){b.clear(b.COLOR_BUFFER_BIT)},kf:function(){b.clear(b.DEPTH_BUFFER_BIT)},Me:function(){b.viewport(0,0,w,y)},A:function(){E!==g.F&&(b.bindFramebuffer(c,v),g.F=E)},rtt:function(G){h=G;g.F!==E&&(b.bindFramebuffer(b.FRAMEBUFFER,v),g.F=E);G.A()},N:function(){b.bindFramebuffer(c,null);g.F=-1},resize:function(G,
U){w=G;y=U;d&&(b.bindRenderbuffer(b.RENDERBUFFER,d),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,w,y))},remove:function(){v===a||B||(b.bindFramebuffer(c,v),b.framebufferTexture2D(c,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),d&&b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,null),b.bindFramebuffer(c,null),b.deleteFramebuffer(v),d&&b.deleteRenderbuffer(d));B=!0}};l.Hc&&q.rd();k.push(q);return q},N:function(){b.bindFramebuffer(c,null);g.F=-1},Ue:function(){b.bindFramebuffer(c,
null);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.viewport(0,0,ba.C(),ba.T());g.F=-1},reset:function(){g.F=-2},aa:function(){0!==g.F&&(b.bindFramebuffer(c,a),g.F=0)},clear:function(){b.viewport(0,0,ba.C(),ba.T());b.clear(b.COLOR_BUFFER_BIT)},m:function(){r.N();k.forEach(function(l){l.remove()});b.deleteFramebuffer(a);r.reset();f=!1;k.splice(0);g.F=-2;g.vc=1}};return r}(),ba=function(){function a(){e="undefined"===typeof Fa?JEContext:Fa;f=!0}function c(d,u){for(var B=0;B<d.length;++B){var E=u.getExtension(d[B]);
if(E)return E}return null}var e=null,f=!1,k={Jc:!1,Tb:null,Ub:null,Nc:!1,re:!1,Vb:null,Oc:!1,Wb:null,Kc:!1,jb:null,le:!1,kb:null,me:!1},g=null,r={ca:!0,da:!0,vb:!0,ad:!1},l=null,h=null,w=null,y="undefined"===typeof window?{}:window,v={B:function(){if(f)return!0;v.reset();f||a();var d=b;if(!g.Jc){g.Tb=v.rc(d);y.GL_EXT_FLOAT=g.Tb;g.Nc=g.Tb?!0:!1;if(g.Nc||v.ea())g.Ub=v.sc(d),g.re=g.Ub?!0:!1,y.GL_EXT_FLOATLINEAR=g.Ub;g.Jc=!0}if(!g.Kc){g.Vb=v.Ma(d);g.Vb&&(g.Oc=!0,y.GL_EXT_HALFFLOAT=g.Vb);if(g.Oc||v.ea())g.Wb=
v.tc(d),y.GL_EXT_HALFFLOATLINEAR=g.Wb;g.bg=g.Wb?!0:!1;g.Kc=!0}g.jb=v.pc(d);g.le=g.jb?!0:!1;y.GL_EXT_COLORBUFFERFLOAT=g.jb;g.kb=v.qc(d);g.me=g.kb?!0:!1;y.GL_EXT_COLORBUFFERHALFFLOAT=g.kb;ka.B();za.B();if(!v.Nd())return!1;la.B();za.ke();return!0},reset:function(){g=Object.assign({},k);l=Object.assign({},r)},C:function(){f||a();return e.C()},T:function(){f||a();return e.T()},ea:function(){f||a();return e.ea()},oc:function(d){v.pc(d);v.qc(d);v.rc(d);v.sc(d);v.Ma(d);v.tc(d)},pc:c.bind(null,["EXT_color_buffer_float",
"WEBGL_color_buffer_float","OES_color_buffer_float"]),qc:c.bind(null,["EXT_color_buffer_half_float","WEBGL_color_buffer_half_float","OES_color_buffer_half_float"]),rc:c.bind(null,["OES_texture_float","MOZ_OES_texture_float","WEBKIT_OES_texture_float"]),sc:c.bind(null,["OES_texture_float_linear","MOZ_OES_texture_float_linear","WEBKIT_OES_texture_float_linear"]),Ma:c.bind(null,["OES_texture_half_float","MOZ_OES_texture_half_float","WEBKIT_OES_texture_half_float"]),tc:c.bind(null,["OES_texture_half_float_linear",
"MOZ_OES_texture_half_float_linear","WEBKIT_OES_texture_half_float_linear"]),xb:function(d){var u=v.Ma(d);return u&&u.HALF_FLOAT_OES?u.HALF_FLOAT_OES:d.HALF_FLOAT||d.FLOAT},ae:function(){return w||b.RGBA32F||b.RGBA},be:function(){return h||b.RGBA16F||b.RGBA},Yd:function(){return l},fc:function(){return l.ca},ef:function(){return l.da},df:function(){return l.vb},Dd:function(){return l.ad},gb:function(d,u,B){function E(){d.bindTexture(d.TEXTURE_2D,null);d.bindFramebuffer(q,null);d.deleteTexture(O);
d.deleteFramebuffer(U)}var q=d.FRAMEBUFFER,G=d.NEAREST,U=d.createFramebuffer();d.bindFramebuffer(q,U);var O=d.createTexture();d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,O);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,G);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,G);d.texImage2D(d.TEXTURE_2D,0,u,3,3,0,d.RGBA,B,
null);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,O,0);if(d.checkFramebufferStatus(d.READ_FRAMEBUFFER||d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)return E(),!1;va.Pb(d);d.clearColor(0,0,0,0);d.viewport(0,0,3,3);d.disable(d.DEPTH_TEST);d.clear(d.COLOR_BUFFER_BIT);la.Na(d);d.bindFramebuffer(q,null);va.Da(d);d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,O);la.Na(d);u=new Uint8Array(36);d.readPixels(0,0,3,3,d.RGBA,d.UNSIGNED_BYTE,u);E();for(B=0;36>B;++B)if(3!==B%4&&3<Math.abs(u[B]-
127))return!1;return!0},nb:function(d){var u={ca:!1,da:!1};d.disable(d.BLEND);d.clearColor(0,0,0,0);d.clear(d.COLOR_BUFFER_BIT);d.RGBA32F&&v.gb(d,d.RGBA32F,d.FLOAT)&&(u.ca=!0,w=d.RGBA32F);!u.ca&&v.gb(d,d.RGBA,d.FLOAT)&&(u.ca=!0,w=d.RGBA);var B=v.xb(d);h=null;d.RGBA16F&&v.gb(d,d.RGBA16F,B)&&(u.da=!0,h=d.RGBA16F);!u.da&&v.gb(d,d.RGBA,B)&&(u.da=!0,h=d.RGBA);return u},Od:function(){var d=ka.instance({width:2});d.hd();var u=za.instance({width:2,isFloat:!0,Ya:3});d.A();u.A();b.flush();b.checkFramebufferStatus(ka.de())!==
b.FRAMEBUFFER_COMPLETE?(za.He(),l.vb=!1):l.vb=!0;d.remove();u.remove()},Pd:function(){var d=!1;v.ea()&&(d="PIXEL_PACK_BUFFER STREAM_READ SYNC_GPU_COMMANDS_COMPLETE WAIT_FAILED fenceSync deleteSync createBuffer".split(" ").every(function(u){return"undefined"!==typeof b[u]}));l.ad=d},Nd:function(){var d=v.nb(b);Object.assign(l,d);if(!l.ca&&!l.da)return!1;v.Od();v.Pd();return!0},m:function(){za.m();va.m();ka.m();la.m();f=!1}};return v}(),W=la,sa=ka,X=za,Ba=function(){function a(F,I,t,n){q.texParameteri(q.TEXTURE_2D,
q.TEXTURE_MIN_FILTER,n?q.NEAREST_MIPMAP_NEAREST:q.LINEAR);var A=null;if(null!==t)try{A=q.getError();if("FUCKING_BIG_ERROR"===A)return!1;q.texImage2D(q.TEXTURE_2D,0,F,4,4,0,q.RGBA,I,t);A=q.getError();if(A!==q.NO_ERROR)return!1}catch(N){return!1}n&&q.generateMipmap(q.TEXTURE_2D);q.clear(q.COLOR_BUFFER_BIT);W.Na(q);A=q.getError();if("FUCKING_BIG_ERROR"===A)return!1;q.readPixels(0,0,2,2,q.RGBA,q.UNSIGNED_BYTE,y);A=q.getError();A===q.INVALID_OPERATION&&"undefined"!==typeof q.PIXEL_PACK_BUFFER&&(q.bindBuffer(q.PIXEL_PACK_BUFFER,
null),q.readPixels(0,0,2,2,q.RGBA,q.UNSIGNED_BYTE,y),A=q.getError());if(A!==q.NO_ERROR)return!1;t=!0;for(n=0;16>n;++n)t=t&&4>Math.abs(y[n]-127);t&&(h.Zc=I,h.Gc=F);return t}function c(F,I){return G.ca&&a(F,q.FLOAT,new Float32Array(v),I)?(l=r.$b,!0):!1}function e(F,I,t){if(!G.da)return!1;var n=za.Id(v),A=ba.Ma(q);if(A&&A.HALF_FLOAT_OES&&a(F,A.HALF_FLOAT_OES,n,I)||q.HALF_FLOAT&&a(F,q.HALF_FLOAT,n,I))return l=r.ta,!0;n=new Float32Array(v);if(a(F,q.FLOAT,n,I))return l=r.ta,!0;q.bindTexture(q.TEXTURE_2D,
t);q.texImage2D(q.TEXTURE_2D,0,q.RGBA,2,2,0,q.RGBA,q.UNSIGNED_BYTE,null);q.bindFramebuffer(h.Ka,R);za.wc(q,t,2,2,n,!1,!1);q.bindFramebuffer(h.Ka,null);q.bindTexture(q.TEXTURE_2D,t);return a(F,null,null,I)?(l=r.ta,!0):!1}function f(F,I,t){w=!0;if(e(F,!0,t)||c(I,!0))return!0;w=!1;return e(F,!1,t)||c(I,!1)?!0:!1}function k(F){if(l===r.O){q=F||b;l=r.RGBA8;w=!0;ba.oc(q);G||(G=ba.nb(q));sa.reset();R=q.createFramebuffer();h.Ka=q.DRAW_FRAMEBUFFER||q.FRAMEBUFFER;q.bindFramebuffer(h.Ka,null);q.clearColor(0,
0,0,0);q.viewport(0,0,2,2);z.O();U=z.Da(q);F=q.createTexture();q.activeTexture(q.TEXTURE0);q.bindTexture(q.TEXTURE_2D,F);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.REPEAT);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.REPEAT);q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST);O=F;var I=F=q.RGBA,t=q.RGBA16F,n=q.RGBA32F;n&&(F=n);t&&(I=t);if((t||n)&&f(I,F,O))return g(),!0;F=I=q.RGBA;if(f(I,F,O))return g(),!0;l=r.RGBA8;g();return!1}}function g(){q.deleteProgram(U.ka);q.deleteTexture(O);
O=U=null}for(var r={O:-1,$b:3,ta:2,RGBA8:0},l=r.O,h={Zc:null,Gc:null,Ka:null},w=!0,y=new Uint8Array(16),v=Array(64),d=0;4>d;++d)for(var u=0;4>u;++u){var B=0===(u+d)%2?1:0,E=4*d+u;v[4*E]=B;v[4*E+1]=B;v[4*E+2]=B;v[4*E+3]=B}var q=null,G=null,U=null,O=null,R=null;return{Cd:function(F){k(F);return w},ec:function(F,I){l===r.O&&(typeof("undefined"!==I)&&(G=I),k(F));return l!==r.RGBA8},eg:function(F){k(F);return l===r.$b},te:function(F){k(F);return l===r.ta},Qf:function(F){k(F);return h.Zc},ce:function(F){k(F);
return h.Gc},m:function(){q=null;w=!0;l=r.O;G=null}}}(),Sb=function(){return{instance:function(a){var c=X.instance(a.alpha),e=X.instance(a.beta);return{Rd:function(){c.h(1);e.h(2)}}}}}(),Gb=function(){return{instance:function(a){var c=null,e=!1,f=!1,k=null,g=!1,r=!1,l=null,h="undefined"===typeof a.preprocessing?!1:a.preprocessing,w="undefined"===typeof a.preprocessingSize?a.size:a.preprocessingSize;a.mask&&(e=!0,Y&&void 0!==Y.xd&&(a.mask=Y.xd+a.mask),c=X.instance({isFloat:!1,url:a.mask}));var y=!1;
a.customInputShader&&(y="s44",z.ac({name:"_",id:y,g:a.customInputShader,Cg:["uSource"],precision:"lowp"}),z.S(y,[{type:"1i",name:"_",value:0}]));switch(h){case "sobel":l="s31";g=!0;break;case "meanNormalization":l="s32";g=!0;break;case "grayScale":l="s28";g=!1;break;case "grayScaleTilt":l="s29";r=!0;g=!1;break;case "rgbGrayTilt":l="s30";r=!0;g=!1;break;case "copy":l=y?y:"s0";break;case "inputLightRegulation":l=y?y:"s28";k=Tb.instance({Fc:w,Yc:a.size,Uc:a.nBlurPass,se:!1});f=!0;break;case "direct":case "none":l=
!1;break;default:l="s3"}r&&z.S(l,[{name:"u26",type:"1f",value:a.tilt}]);e&&(l+="Mask");var v=X.instance({isFloat:!1,isPot:!1,width:a.size}),d={C:function(){return w},yb:function(){return d.C()},ge:function(){return f?k.Cc():v},U:function(){sa.aa();l&&(z.set(l),g&&z.G("u27",1/a.size),v.fa(),e&&c.h(1),W.l(!1,!1),v.h(0),f&&k.process(v))},m:function(){v.remove();e&&c.remove()}};return d}}}(),Hb=function(){return{instance:function(a){"undefined"===typeof a.normalize&&(a.normalize=!1);var c={input:null,
Ha:null,Cb:null,Y:null,$a:null,Jb:null,Kb:null},e=null,f=[],k=[],g=!1,r=null,l=!0,h=-1,w=a.isReorganize?a.isReorganize:!1,y=a.kernelsCount?!0:!1,v=a.dynPelu?Sb.instance(a.dynPelu):!1,d=v?!0:!1,u={isEnabled:!1};a.qe?(a.sparsity="undefined"!==typeof a.sparsity?a.sparsity:a.bb.yb(),l=!1):"full"===a.connectivityUp&&(a.sparsity=a.bb.yb());var B={elu:"s15",elu01:"s16",relu:"s14",arctan:"s18",sigmoid:"s13",copy:"s0",softplus:"s19",dynPelu:"s17"}[a.activation],E=a.sparsity*a.sparsity,q=!1,G=a.size,U="";if(a.maxPooling){switch(a.maxPooling.size){case 2:U=
"s33";break;case 4:U="s34"}q=!0;G/=a.maxPooling.size;c.Jb=X.instance({isFloat:!0,isPot:!1,width:G})}var O=void 0!==a.ze&&a.ze?!0:!1,R=null,F=null,I=null;if(O){R="s45"+a.index.toString();z.Ec("s45",R,[((a.normalization.n-1)/2).toFixed(1)]);z.S(R,[{type:"1i",name:"u1",value:0},{type:"2f",name:"u7",value:[1/a.size,1/a.size]},{type:"1f",name:"u6",value:a.normalization.alpha},{type:"1f",name:"u9",value:a.normalization.beta},{type:"1f",name:"u31",value:a.normalization.k}]);var t={isFloat:!0,isPot:!0,width:a.size};
F=X.instance(t);I=X.instance(t)}var n=-1,A=null;l&&(c.Y=X.instance({isFloat:!0,isPot:!1,width:a.size}));c.Ha=X.instance(a.bias);var N={C:function(){return a.size},yb:function(){return G},zc:function(){return a.classesCount},zd:function(D){e.h(D)},Ce:function(){a.remap&&a.remap.isEnabled&&(u={isEnabled:!0,ve:X.instance({isFloat:!1,isFlipY:!1,array:new Uint8Array(a.remap.maskTexture.data),width:a.remap.maskTexture.width,isPot:!1}),Va:a.remap.layers.map(function(D){return a.parent.fe(D)}),depth:a.remap.depth})},
Ie:function(){switch(a.connectivityUp){case "direct":A=Ub.instance(a.connectivity);break;case "square":A=Vb.instance(a.connectivity);break;case "squareFast":A=Wb.instance(a.connectivity,a.activation);break;case "full":A=Xb.instance(a.connectivity);break;case "conv":h=a.kernelsCount,A=Yb.instance(a.connectivity),w&&(c.$a=X.instance({width:G,isFloat:!0,isFlipY:!1,isPot:!1}))}if(A.qa){var D=a.size*a.sparsity;n=Math.log(D/a.size)/Math.log(2);c.input=X.instance({isMipmap:!0,isFloat:!0,isPot:!0,width:D,
Eb:n});c.Cb=X.instance({isFloat:!0,isPot:!0,width:a.size})}},U:function(D){e=D;A.qa?(c.input.fa(),y&&c.Ha.h(2),A.U(u),c.input.h(0),c.input.Vd(n),c.Cb.fa(),y?z.set("s0"):(z.set("s27"),z.G("u25",E),c.Ha.h(1)),c.input.Ad(n,0),W.l(!1,!1),z.set(B),O?F.A():c.Y.A(),c.Cb.h(0),d&&v.Rd(),W.l(!1,!1)):(c.Y.fa(),c.Ha.h(1),A.U());O&&(z.set(R),I.A(),F.h(0),W.l(!1,!1),z.set("s46"),z.G("u6",1),c.Y.A(),I.h(1),W.l(!1,!1));if(l)return q?(c.Jb.fa(),c.Y.h(0),z.set(U),z.Ea("u7",1/a.size,1/a.size),W.l(!1,!1),D=c.Jb):D=c.Y,
D.h(0),w&&(c.$a.A(),z.set("s21"),z.Ea("u12",h,G/h),W.l(!1,!1),D=c.$a,c.$a.h(0)),D;D=c.Y;a.normalize&&(z.set("gpuRawAvg"===g?"s8":"s7"),z.G("u4",1/a.size),c.Kb.fa(),c.Y.h(0),W.l(!1,!1),D=c.Kb);switch(g){case "cpuRGBA2Float":D.mc(!1);D=N.De(D);r(D);break;case "cpuMeanFloat":D.mc(!0);D=D.Ee();r(D);break;case "gpuRawAvg":case "gpuRaw":D.h(0);case "none":null!==r&&r(D)}return!1},Kd:function(D){D&&(g=D.Lb||"none",r=D.Ib||null);c.Y=X.instance({isFloat:!0,isPot:!0,isMipmap:!1,width:a.size});D="undefined"!==
typeof a.classesCount&&a.classesCount?a.classesCount:a.size*a.size;for(var m=0,K=0,H=0;m<D;++m)f.push(K+(a.size-1-H)*a.size),k.push([-1,-1,-1,-1]),++K,K===a.size&&(K=0,++H);a.normalize&&(c.Kb=X.instance({isFloat:!0,isPot:!0,width:a.size}))},De:function(D){var m=D.bd();f.forEach(function(K,H){k[H][0]=m[0][K];k[H][1]=m[1][K];k[H][2]=m[2][K];k[H][3]=m[3][K]});return k},m:function(){for(var D in c){var m=c[D];m&&m.remove()}A&&(A.m(),A=null)}};a.bb&&N.Ie(a.bb);return N}}}(),Ub=function(){return{instance:function(a){var c=
X.instance(a.weights);return{qa:!0,Pa:function(){return 1},m:function(){c.remove()},je:function(){return c},U:function(){z.set("s26");c.h(1);W.l(!1,!1)}}}}}(),Xb=function(){return{instance:function(a){var c=a.fromLayerSize,e=X.instance(a.weights);return{qa:!0,Pa:function(){return c},m:function(){e.remove()},U:function(f){if(f.isEnabled){z.set("s24");f.ve.h(3);var k,g=Math.min(f.Va.length,f.depth);for(k=0;k<g;++k)f.Va[k].zd(4+k)}else z.set("s23");z.G("u16",a.toLayerSize);e.h(1);W.l(!1,!1)}}}}}(),Vb=
function(){return{instance:function(a){for(var c=a.fromLayerSize,e=a.toLayerSize,f=a.toSparsity,k=f*e,g=k/c,r=c/e,l=0,h=0,w=0,y=Array(f*e*f*e*4),v=Array(f*e*f*e*4),d=Array(c*c),u=0;u<d.length;++u)d[u]=0;u=Math.floor(f/2);for(var B=.5/e,E=.5/c,q=.5/k,G=0;G<e;++G)for(var U=Math.round(G*r),O=0;O<e;++O){var R=Math.round(O*r),F=G/e,I=O/e;F+=B;I+=B;for(var t=0;t<f;++t){var n=U+t-u;0>n&&(n+=c);n>=c&&(n-=c);for(var A=0;A<f;++A){var N=l/k,D=h/k,m=R+A-u;0>m&&(m+=c);m>=c&&(m-=c);var K=n/c,H=m/c;D=1-D-1/k;K+=
E;H+=E;N+=q;D+=q;var p=G*f+t,ca=O*f+A;ca=e*f-ca-1;p=ca*e*f+p;y[4*p]=N;y[4*p+1]=D;y[4*p+2]=K;y[4*p+3]=H;H=d[m*c+n]++;p=H%g;K=n*g+p;m=m*g+(H-p)/g;m=c*g-1-m;m=m*c*g+K;v[4*m]=N;v[4*m+1]=D;v[4*m+2]=F;v[4*m+3]=I;++l>=k&&(l=0,++h);++w}}}d=null;var pa=X.instance(a.weights);delete a.weights.data;var Ca=X.instance({width:k,isFloat:!0,array:new Float32Array(v),isPot:!0});v=null;var qa=X.instance({width:k,isFloat:!0,array:new Float32Array(y),isPot:!0});y=null;return{qa:!0,Pa:function(){return g},m:function(){Ca.remove();
qa.remove();pa.remove()},U:function(){z.set("s22");pa.h(1);qa.h(2);W.l(!1,!1)}}}}}(),Yb=function(){return{instance:function(a){var c=a.kernelsCount,e=a.toSparsity,f=e*a.toLayerSize/a.fromLayerSize,k=X.instance(a.weights);return{qa:!0,Pa:function(){return f},Zf:function(){return e},je:function(){return k},m:function(){k.remove()},U:function(){z.set("s25");z.G("u22",c);z.G("u23",e);z.G("u16",a.toLayerSize);z.G("u24",a.fromLayerSize);k.h(1);W.l(!1,!1)}}}}}(),Wb=function(){return{instance:function(a,
c){var e=a.fromLayerSize,f=a.toLayerSize,k=a.toSparsity,g=a.stride?a.stride:1,r=k*f/e,l=f<e,h=e/f,w=X.instance(a.weights),y="s47"+[e.toString(),f.toString(),k.toString(),g.toString(),c].join("_");z.Td(y)||(a=Qb.Wd(c,"gl_FragColor","gl_FragColor"),f=[{type:"1f",name:"u16",value:f},{type:"1f",name:"u30",value:g}],l&&f.push({type:"1f",name:"u24",value:e}),e=[(l?r:k).toFixed(1),a],l&&e.push(h.toFixed(1)),z.Ec(l?"s39":"s38",y,e),z.S(y,f.concat([{type:"1i",name:"u14",value:0},{type:"1i",name:"u21",value:1},
{type:"1i",name:"u13",value:3}])));return{qa:!1,Pa:function(){return r},m:function(){w.remove()},U:function(){z.set(y);w.h(3);W.l(!1,!1)}}}}}(),Tb=function(){return{instance:function(a){var c=a.Uc?a.Uc:3,e=a.Fc?a.Fc:64,f=a.Yc?a.Yc:64,k=a.se?!0:!1;a={isFloat:!1,width:e,isPot:!1,isFlipY:!1};var g=X.instance(a),r=X.instance(a),l=X.instance(a),h=X.instance(a),w=X.instance({isFloat:!0,width:f,isPot:!1,isFlipY:!1}),y=1/e;return{process:function(v){z.set("s35");h.A();W.l(k,!1);z.set("s36");for(var d=0;d<
c;++d)g.A(),z.Ea("u7",y,0),W.l(k,!1),l.A(),h.h(0),W.l(k,!1),r.A(),g.h(0),z.Ea("u7",0,y),W.l(k,!1),h.A(),l.h(0),W.l(k,!1),d!==c-1&&r.h(0);z.set("s37");w.A();v.h(0);r.h(1);h.h(2);W.l(k,!1);w.h(0)},Cc:function(){return w}}}}}(),T={ie:function(){return T.kc()?document.createElement("video"):!1},za:function(a,c){a[c]=!0;a.setAttribute(c,"true")},Gd:function(){var a=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(c)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))a=!0;return a},hc:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},Xd:function(){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return a&&a.length&&2<a.length?[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]:[0,0,0]},Pc:function(){try{return window.matchMedia("(orientation: portrait)").matches?!0:!1}catch(a){return window.innerHeight>window.innerWidth}},Fd:function(){return T.ic()||T.hc()},ic:function(){var a=navigator.userAgent.toLowerCase();
return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")?!0:!1},Ff:function(){return T.Gd()?T.Pc()?window.innerHeight/window.innerWidth*45:45:45},kc:function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?!0:!1},pause:function(a){a.pause()},sg:function(a){a.play()},release:function(a){a.pause();a.videoStream&&a.videoStream.stop();a.videoStream=null},jc:function(a){if(!a)return a;var c=null;if(a.video){var e=function(f){return f&&"object"===typeof f?Object.assign({},f):f};c={};
"undefined"!==typeof a.video.width&&(c.width=e(a.video.width));"undefined"!==typeof a.video.height&&(c.height=e(a.video.height));"undefined"!==typeof a.video.facingMode&&(c.facingMode=e(a.video.facingMode))}c={audio:a.audio,video:c};"undefined"!==typeof a.deviceId&&(c.deviceId=a.deviceId);return c},nd:function(a){var c=a.video.width;a.video.width=a.video.height;a.video.height=c;return a},Jd:function(a){function c(d){return[480,576,640,648,720,768,800,960,1080,1152,1280,1366,1920].sort(function(u,
B){return Math.abs(u-d)-Math.abs(B-d)})}function e(d){var u=T.jc(a);d=d(u);k.push(d);f(d)}function f(d){if(d.video&&d.video.facingMode&&d.video.facingMode.exact){var u=d.video.facingMode.exact;d=T.jc(d);delete d.video.facingMode.exact;d.video.facingMode.ideal=u;k.push(d)}}var k=[];if(!a||!a.video)return k;f(a);if(a.video.width&&a.video.height){if(a.video.width.ideal&&a.video.height.ideal){var g=c(a.video.width.ideal).slice(0,3),r=c(a.video.height.ideal).slice(0,3),l={},h=0;for(l.ha=void 0;h<g.length;l=
{ha:l.ha},++h){l.ha=g[h];var w={},y=0;for(w.ga=void 0;y<r.length;w={ga:w.ga},++y)if(w.ga=r[y],l.ha!==a.video.width.ideal||w.ga!==a.video.height.ideal){var v=Math.max(l.ha,w.ga)/Math.min(l.ha,w.ga);v<4/3-.1||v>16/9+.1||e(function(d,u){return function(B){B.video.width.ideal=d.ha;B.video.height.ideal=u.ga;return B}}(l,w))}}}e(function(d){return T.nd(d)})}a.video.width&&a.video.height&&(a.video.width.ideal&&a.video.height.ideal&&e(function(d){delete d.video.width.ideal;delete d.video.height.ideal;return d}),
e(function(d){delete d.video.width;delete d.video.height;return d}));a.video.facingMode&&(e(function(d){delete d.video.facingMode;return d}),a.video.width&&a.video.height&&e(function(d){T.nd(d);delete d.video.facingMode;return d}));k.push({audio:a.audio,video:!0});return k},Qe:function(a){if(T.Pc()){if(!a||!a.video)return!1;var c=a.video.width,e=a.video.height;if(!c||!e)return!1;if(c.ideal&&e.ideal&&c.ideal>e.ideal)return a.video.height=c,a.video.width=e,!0}return!1},Xa:function(a){a.volume=0;T.za(a,
"muted");if(T.ic()){if(1===a.volume){var c=function(){a.volume=0;window.removeEventListener("mousemove",c,!1);window.removeEventListener("touchstart",c,!1)};window.addEventListener("mousemove",c,!1);window.addEventListener("touchstart",c,!1)}setTimeout(function(){a.volume=0;T.za(a,"muted")},5)}},od:function(a,c,e){return new Promise(function(f,k){if(a.srcObject&&a.srcObject.getVideoTracks){var g=a.srcObject.getVideoTracks();1!==g.length?k("INVALID_TRACKNUMBER"):(g=g[0],c?T.get(a,f,k,e):(g.stop(),
f()))}else k("BAD_IMPLEMENTATION")})},Dc:function(a,c,e,f){function k(r){g||(g=!0,e(r))}var g=!1;return navigator.mediaDevices.getUserMedia(f).then(function(r){function l(){setTimeout(function(){if(a.currentTime){var h=a.videoWidth,w=a.videoHeight;if(0===h||0===w)k("VIDEO_NULLSIZE");else{h&&(a.style.width=h.toString()+"px");w&&(a.style.height=w.toString()+"px");h={Ed:null,Ne:null,we:null};try{var y=r.getVideoTracks()[0];y&&(h.we=y,h.Ed=y.getCapabilities(),h.Ne=y.getSettings())}catch(v){}T.Fd()?a.parentNode&&
null!==a.parentNode?(g||c(a,r,h),setTimeout(function(){a.play()},100)):(document.body.appendChild(a),T.Xa(a),g||c(a,r,h),setTimeout(function(){a.style.transform="scale(0.0001,0.0001)";a.style.position="fixed";a.style.bottom="0px";a.style.right="0px";T.Xa(a);setTimeout(function(){a.play()},100)},80)):g||c(a,r,h)}}else k("VIDEO_NOTSTARTED")},700)}"undefined"!==typeof a.srcObject?a.srcObject=r:(a.src=window.URL.createObjectURL(r),a.videoStream=r);T.Xa(a);a.addEventListener("loadeddata",function(){var h=
a.play();T.Xa(a);"undefined"===typeof h?l():h.then(function(){l()}).catch(function(){k("VIDEO_PLAYPROMISEREJECTED")})},!1)}).catch(function(r){k(r)})},get:function(a,c,e,f){if(!a)return e&&e("VIDEO_NOTPROVIDED"),!1;if(!T.kc())return e&&e("MEDIASTREAMAPI_NOTFOUND"),!1;if(f&&f.video){if(T.hc()){var k=T.Xd();0!==k[0]&&(12>k[0]||12===k[0]&&2>k[1])&&T.Qe(f)}f.video.width&&f.video.width.ideal&&(a.style.width=f.video.width.ideal+"px");f.video.height&&f.video.height.ideal&&(a.style.height=f.video.height.ideal+
"px")}T.za(a,"autoplay");T.za(a,"playsinline");f&&f.audio?a.volume=0:T.za(a,"muted");T.Dc(a,c,function(){function g(l){if(0===l.length)e("INVALID_FALLBACKCONSTRAINTS");else{var h=l.shift();T.Dc(a,c,function(){g(l)},h)}}var r=T.Jd(f);g(r)},f)},he:function(a){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return a(!1,"NOTSUPPORTED"),!1;navigator.mediaDevices.enumerateDevices().then(function(c){(c=c.filter(function(e){return e.kind&&-1!==e.kind.toLowerCase().indexOf("video")&&e.label&&
e.deviceId}))&&c.length&&0<c.length?a(c,!1):a(!1,"NODEVICESFOUND")}).catch(function(){a(!1,"PROMISEREJECTED")})},ff:function(a,c,e){var f={};f[c]=e;c=[];c.push(f);a.applyConstraints({advanced:c}).catch(function(){})}},Aa=function(){var a={n:5,Fb:1,Rc:0,Oa:[30,45],La:[2,200],k:.7,Ve:200,Be:.05},c=-1,e=null,f=-1,k=-1,g=0,r=-1,l=-1,h=0,w=0,y=a.La[1],v={Ac:function(){switch(c){case -1:return-1;case 0:return l+e.Rc;case 1:return h}},Jf:function(d){return Math.pow(Math.min(Math.max(r,0),e.n-1)/(e.n-1),
d||1)},B:function(d){e=Object.assign({},a,d);r=l=e.Fb;c=0;v.reset()},Re:function(d){d=("undefined"===typeof d?Date.now():d)||0;var u=Math.min(Math.max(d-w,e.La[0]),e.La[1]);y=u;w=d;var B=-1===f?0:e.k;f=Math.min(Math.max(1E3/u,5),120)*(1-B)+f*B;d-k>e.Ve&&5<++g&&(u=e.k,r=r*(1-u)+(f<e.Oa[0]?l-1:f>e.Oa[1]?l+1:l)*u,Math.abs(r-l)>1-e.Be&&(u=Math.min(Math.max(Math.round(r),0),e.n-1),u!==l&&(r=l=u,f=(e.Oa[1]-e.Oa[0])/2)),k=d)},jd:function(d){h=d;c=1},qd:function(){c=0;v.reset()},reset:function(){y=a.La[1];
k=f=-1;g=0},$d:function(){return y}};return v}(),ub=function(){var a={Wc:4,ab:[1.5,1.5,2],M:[.1,.1,.1],ed:1,P:-1,K:-1,Pe:2,Ae:1,fd:!0,Sd:.8},c=null,e=[],f=0,k=[.5,.5,1];return{B:function(g){c=Object.assign({},a,g);e.splice(0);g=c.ab[0]*c.M[0];var r=c.ab[1]*c.M[1],l=1/(1+c.ab[2]*c.M[2]),h=c.ed*Math.min(c.P,c.K),w=h/c.P;h/=c.K;var y=.5*c.Sd;y*=y;for(var v=0;v<c.Wc;++v){var d=Math.pow(l,v),u=w*d,B=h*d;d=u*g;var E=B*r,q=u/2;B/=2;for(var G=1+(1-q-q)/d,U=1+(1-B-B)/E,O=0;O<U;++O)for(var R=B+O*E,F=R-.5,I=
0;I<G;++I){var t=q+I*d,n=t-.5;n*n+F*F>y||e.push([t,R,u*c.Ae])}}c.fd&&e.sort(function(A,N){var D=A[0]-.5;A=A[1]-.5;var m=N[0]-.5;N=N[1]-.5;return D*D+A*A-(m*m+N*N)})},get:function(){var g=e.length;if(0===g)return k;f>=g&&(f=0);var r=e[Math.floor(f)];f=(f+1/c.Pe)%g;return r}}}(),Y={neuralNetworkPath:"NN_DEFAULT.json",bc:0,wd:25,hb:[2,7],Fe:{threshold:1,nScaleLevels:2,scale0Factor:.8,overlapFactors:[2,2,3],scanCenterFirst:!0,nDetectsPerLoop:-1},Se:50,Tc:.5,
Sc:.4,xe:8,Oe:{translationFactorRange:[.0015,.005],rotationFactorRange:[.003,.02],qualityFactorRange:[.9,.98],alphaRange:[.05,1]},Ba:[.65,1,.262],M:[.092,.092,.3],td:.2,vd:2,ud:.1,ye:8,Vc:1,Ud:Xa.Wa.bind(null,.3,.7),Ye:20,Md:!0,ld:3},ma={facingMode:"user",idealWidth:800,idealHeight:600,minWidth:480,maxWidth:1920,minHeight:480,maxHeight:1920,rotate:0,flipX:!1},da={Gb:-3,ue:-1,error:-2,ready:1,play:2,pause:3},ia=da.Gb,x=null,Zb={Sa:!1,Sb:null,element:null,L:null,D:[0,0],I:[.5,.5],u:[.5,0,0,.5],cb:0,
ya:null,Ra:!1},L=null,$b={xa:null,Ia:null,antialias:!0,Zb:"./",sa:null,ba:null,Fa:Y.bc,$c:Y.bc,Ta:!1,ma:!0},Pa=null,na=null,ua=null,Qa=1,Oa={Ob:-1,ob:-1},Z=null,ac={P:0,K:0,D:[0,0],oa:null},V={ra:null,buffer:null,M:null,Ba:null,X:Y.Vc,Aa:null},Sa=null,oa=null,Wa=null,Na=null,J={o:1,ja:0,V:null,Lc:!1,Qc:0,Hb:0},fb=[],gb=[],Eb={VERSION:"2.0.9",init:function(a){function c(){ia!==da.error&&2===++f&&(Ja(),yb(),Ia(),L.xa&&(ia=da.ready,L.xa(!1,{GL:b,canvasElement:L.ba,videoTexture:x.L.get(),videoTransformMat2:x.u,
maxFacesDetected:J.o,videoElement:x.element}),db()),cb())}if(ia!==da.Gb)return a.callbackReady&&a.callbackReady("ALREADY_INITIALIZED"),!1;ia=da.ue;x=Object.assign({},Zb);L=Object.assign({},$b);Z=Object.assign({},ac);J.V=[0];V.M=Y.M.slice(0);V.Ba=Y.Ba.slice(0);"undefined"!==typeof a.antialias&&(L.antialias=a.antialias);a.callbackReady&&(L.xa=a.callbackReady);a.callbackTrack&&(L.Ia=a.callbackTrack);a.nExpressions&&(V.X=a.nExpressions);a.expressionsEasings&&(V.Aa=a.expressionsEasings);"undefined"!==
typeof a.animateDelay&&(L.Fa=a.animateDelay);"undefined"!==typeof a.NNCPath&&(L.Zb=a.NNCPath);"undefined"!==typeof a.NNC&&(L.sa=a.NNC);"undefined"!==typeof a.maxFacesDetected&&(J.o=Math.max(1,a.maxFacesDetected));"undefined"!==typeof a.followZRot&&(L.ma=a.followZRot?!0:!1);if(J.o>Y.xe)return Ha("MAXFACES_TOOHIGH"),!1;if(!a.canvasId&&!a.canvas)return Ha("NO_CANVASID"),!1;L.ba=a.canvas?a.canvas:document.getElementById(a.canvasId);if(!L.ba)return Ha("INVALID_CANVASID"),!1;Z.P=L.ba.width;Z.K=L.ba.height;
if(!Z.P||!Z.K)return Ha("INVALID_CANVASDIMENSIONS"),!1;for(var e=0;e<J.o;++e)fb.push(new Float32Array(Y.ye)),gb.push(0);Aa.B({Fb:0,n:Y.hb[1]-Y.hb[0]+1,Rc:Y.hb[0]});na=Object.create(Y.Fe);a.scanSettings&&(Object.assign(na,a.scanSettings),-1!==na.nDetectsPerLoop?Aa.jd(na.nDetectsPerLoop):Aa.qd());ua=Object.create(Y.Oe);a.stabilizationSettings&&Object.assign(ua,a.stabilizationSettings);var f=0;a.videoSettings&&a.videoSettings.videoElement?Ya(a.videoSettings.videoElement,c):(a.videoSettings&&Object.assign(ma,
a.videoSettings),Ab(a.onWebcamAsk,a.onWebcamGet,function(k){Ya(k,c)}));Mb(function(k){if(!Nb())return!1;Pa=new Fb({Va:k.layers,Lb:"gpuRawAvg",Ib:Pb});z.sd([{id:"s50",name:"_",la:"attribute vec2 a0;uniform mat2 u32;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=vec2(.5,.5)+u32*a0;}",Ga:["a0"],ua:[2],g:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:["u1","u32"],precision:"lowp"},{id:"s51",name:"_",g:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",
la:"attribute vec2 a0;uniform sampler2D u33;uniform mat2 u32;uniform vec2 u34;uniform float u35,u36,u37;varying vec2 vv0;void main(){vec4 a=texture2D(u33,vec2(.17,u35));vec2 f=a.gb,g=a.a*u34,b=a0;b.x*=u37;float c=cos(u36),d=sin(u36);vec2 h=mat2(c,d,-d,c)*b,i=f+h*.5*g,j=i-.5;vv0=.5+2.*u32*j,gl_Position=vec4(a0,0.,1.);}",Ga:["a0"],ua:[2],i:"u1 u33 u34 u35 u36 u37 u32".split(" "),precision:"lowp"},{id:"s52",name:"_",g:"uniform sampler2D u38,u33;uniform vec3 u39,u40;uniform float u41,u42,u35,u43,u36,u44;const vec4 e=vec4(.25,.25,.25,.25);void main(){vec4 d=texture2D(u38,vec2(.625,.625)),f=texture2D(u38,vec2(.875,.625)),a=texture2D(u33,vec2(.17,u35));float g=dot(d-f,e);bool h=g>u42;h?a.r=2.:a.r>u41?a.r=0.:a.r>1.9?a.r+=1.:0.,a.r*=u43;if(a.r<.9)a=vec4(1.,u39);else{a.r*=step(1.9,a.r);float i=dot(e,texture2D(u38,vec2(.875,.875))),j=dot(e,texture2D(u38,vec2(.125,.625))),k=dot(e,texture2D(u38,vec2(.375,.625))),b=cos(u36),c=sin(u36);vec2 l=mat2(b,c*u44,-c/u44,b)*vec2(i,j);a.gba+=vec3(l,k)*u40*a.a;}gl_FragColor=a;}",
la:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",i:"u38 u33 u39 u41 u40 u43 u36 u44 u42 u35".split(" ")},{id:"s53",name:"_",la:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",g:"uniform sampler2D u38;const vec4 e=vec4(.25,.25,.25,.25);const vec3 f=vec3(.5,.5,.5);void main(){float a=dot(e,texture2D(u38,vec2(.125,.875))),b=dot(e,texture2D(u38,vec2(.375,.875))),c=dot(e,texture2D(u38,vec2(.625,.875))),d=dot(e,texture2D(u38,vec2(.625,.625)));vec3 g=vec3(a,b,c)*.5+f;gl_FragColor=vec4(g,d);}",
i:["u38"]},{id:"s54",name:"_",la:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",g:"uniform sampler2D u38;const vec4 e=vec4(.25,.25,.25,.25);void main(){float a=dot(e,texture2D(u38,vec2(.375,.375))),b=dot(e,texture2D(u38,vec2(.625,.375))),c=dot(e,texture2D(u38,vec2(.875,.375))),d=dot(e,texture2D(u38,vec2(.125,.125)));gl_FragColor=vec4(a,b,c,d);}",i:["u38"]},{id:"s49",name:"_",g:"uniform sampler2D u33;uniform vec2 u45;uniform float u46;varying vec2 vv0;void main(){float f=step(.5,mod(gl_FragCoord.y+1.5,2.)),c=step(.33,vv0.x);vec4 a=texture2D(u33,vv0+u45);a.a=mix(a.a*u46,a.a,c);vec4 d=floor(255.*a),g=255.*(255.*a-d),b=mix(d,g,f)/255.;b.x=mix(step(a.x,1.5),b.x,c),gl_FragColor=b;}",
i:["u33","u46","u45"]}]);tb();Lb();ib();hb();c()});return!0},destroy:function(){return new Promise(function(a,c){Eb.toggle_pause(!0,!0).catch(function(){c()}).then(function(){Pa&&Pa.m();Fa.m();Pa=oa=Sa=null;fb.splice(0);gb.splice(0);Z.oa=null;V.ra=null;x.L=null;ia=da.Gb;a()})})},toggle_pause:function(a,c){if(!Va())return Promise.reject();var e=null;e=x.Ra?Promise.resolve():c?T.od(x.element,!a,x.ya):Promise.resolve();a?pb():e.then(function(){cb()});return e},update_videoSettings:function(a){pb();return new Promise(function(c){T.od(x.element,
!1,x.ya).then(function(){Object.assign(ma,a);Ab(null,null,function(e){Ya(e,function(){Ja();Ia();cb();c()})})})})},toggle_slow:function(a){Va()&&ia===da.play&&(a&&!L.Ta?(L.$c=L.Fa,na.nDetectsPerLoop=1,this.set_animateDelay(100),L.Ta=!0):!a&&L.Ta&&(na.nDetectsPerLoop=-1,this.set_animateDelay(L.$c),L.Ta=!1))},set_animateDelay:function(a){L.Fa=a},resize:function(){if(!Va())return!1;var a=L.ba.width,c=L.ba.height;if(!jb()&&a===Z.P&&c===Z.K)return!1;Z.P=a;Z.K=c;z.O();ib();hb();Ja();Ia();return!0},set_inputTexture:function(a,
c,e){x.D[0]=c;x.D[1]=e;x.L=X.instance({width:c,height:e,zb:a});x.Sa=!0;Ja();db();Ia()},reset_GLState:function(){db();Z.oa.remove();V.ra.remove();tb()},render_video:function(){sa.N();z.set("s50");b.viewport(0,0,Z.P,Z.K);x.L.h(0);W.l(!0,!0)},reset_inputTexture:function(){x.Sa=!1;x.L=x.Sb;jb();Ja();Ia()},get_videoDevices:function(a){return T.he(a)},set_scanSettings:function(a){Object.assign(na,a);-1!==na.nDetectsPerLoop?Aa.jd(na.nDetectsPerLoop):Aa.qd();ib();hb()},set_stabilizationSettings:function(a){Object.assign(ua,
a)},set_videoOrientation:function(a,c){Va()&&(ma.flipX=c,ma.rotate=a,Ja(),Ia())},update_videoElement:function(a,c){Ya(a?a:x.element,function(){yb();Ja();Ia();c&&c()})},create_new:function(){return window.JEEFACEFILTERAPIGEN()}};return Eb};window.JEEFACEFILTERAPI=window.JEEFACEFILTERAPIGEN();
if(typeof(module)!=='undefined'){module.exports=window.JEEFACEFILTERAPI;}
window.JEEFACEFILTERAPI.FAKEDOM=FAKEDOM;